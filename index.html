<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monster Survivors - 复古像素生存射击游戏</title>
    <meta name="description" content="Monster Survivors是一款复古风格的像素生存射击游戏，融合roguelite元素，提供紧张刺激的游戏体验。免费畅玩，支持多平台！">
    <meta name="robots" content="index, follow">
    <meta name="author" content="独立游戏开发团队">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S2WRT969VY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-S2WRT969VY');
    </script>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://monstersurvivors.game/">
    <meta property="og:title" content="Monster Survivors - 复古像素生存射击游戏">
    <meta property="og:description" content="体验这款具有挑战性的roguelite生存射击游戏，使用独特武器击败成群的怪物！">
    <meta property="og:image" content="https://monstersurvivors.game/images/og-image.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://monstersurvivors.game/">
    <meta property="twitter:title" content="Monster Survivors - 复古像素生存射击游戏">
    <meta property="twitter:description" content="体验这款具有挑战性的roguelite生存射击游戏，使用独特武器击败成群的怪物！">
    <meta property="twitter:image" content="https://monstersurvivors.game/images/twitter-image.jpg">
    
    <!-- 搜索引擎优化标签 -->
    <link rel="canonical" href="https://monstersurvivors.game/">
    <meta name="google-site-verification" content="your-verification-code">
    
    <!-- 地区和语言标签 -->
    <meta name="geo.region" content="US-CA">
    <meta name="geo.placename" content="San Francisco">
    <meta name="geo.position" content="37.7749;-122.4194">
    <meta name="ICBM" content="37.7749, -122.4194">
    
    <!-- 移动应用关联 -->
    <meta name="apple-itunes-app" content="app-id=yourAppID">
    <meta name="google-play-app" content="app-id=com.yourcompany.monstersurvivors">
    
    <!-- 网站图标 -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <meta name="keywords" content="retro games online, pixel survival game, roguelike game, free browser games no download, 2D pixel games, old school arcade games, offline browser games, indie pixel games, free retro style games, free roguelite games, vampire survivors alternative, action survival browser game, best online games 2024, pixel art games, addictive browser games">
    <meta name="theme-color" content="#34C759">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Monster Survivors">
    
    <!-- 增强SEO -->
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="format-detection" content="telephone=no">
    <meta name="color-scheme" content="dark light">
    
    <!-- Enhanced SEO Tags -->
    <link rel="next" href="/blog/">
    <meta name="rating" content="general">
    <meta name="revisit-after" content="7 days">
    <meta name="language" content="English">
    <meta name="distribution" content="global">
    <meta name="target" content="all">
    <meta name="classification" content="games">
    <meta name="category" content="browser games, retro games, pixel games">
    
    <!-- Additional SEO Tags Based on Keyword Research -->
    <meta name="news_keywords" content="retro games online, browser games 2024, free pixel games, old school arcade games, roguelike browser game">
    <meta name="thumbnail" content="https://monstersurvivors.com/images/2.webp">
    <meta name="topic" content="retro gaming, pixel art games, browser games">
    <meta name="summary" content="A free-to-play retro pixel survival game with roguelike elements. Battle endless hordes of monsters, collect power-ups, and survive as long as possible in this no-download browser game.">
    
    <!-- 性能优化 - 添加资源提示 -->
    <script>
    // 内联关键性能优化代码
    (() => {
        // 添加页面加载进度条
        const progressBar = document.createElement('div');
        progressBar.id = 'page-load-progress';
        progressBar.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 4px;
            background-color: #34C759;
            z-index: 9999;
            transition: width 0.3s ease;
            background-image: linear-gradient(to right, #34C759, #4AFF8F, #34C759);
            background-size: 200% 100%;
            animation: progress-animation 2s linear infinite;
        `;
        
        document.addEventListener('DOMContentLoaded', () => {
            if (!document.head.contains(progressBar)) {
                document.body.appendChild(progressBar);
            }
            
            let loadProgress = 0;
            const updateProgress = () => {
                loadProgress += (100 - loadProgress) / 12;
                progressBar.style.width = loadProgress + '%';
                if (loadProgress < 99) {
                    requestAnimationFrame(updateProgress);
                }
            };
            updateProgress();
        });
        
        window.addEventListener('load', () => {
            progressBar.style.width = '100%';
            setTimeout(() => {
                progressBar.style.opacity = '0';
                setTimeout(() => {
                    progressBar.remove();
                }, 300);
            }, 500);
        });
        
        // 添加关键样式
        const style = document.createElement('style');
        style.textContent = `
            @keyframes progress-animation {
                0% { background-position: 200% 0; }
                100% { background-position: -200% 0; }
            }
            
            /* 优化图片加载 */
            img[loading="lazy"] {
                opacity: 0;
                transition: opacity 0.3s ease;
            }
            
            img.loaded {
                opacity: 1;
            }
            
            /* 骨架屏 */
            @keyframes skeleton-loading {
                0% { background-position: 200% 0; }
                100% { background-position: -200% 0; }
            }
            
            .advanced-skeleton {
                background: linear-gradient(90deg, #192B21 25%, #1e352a 50%, #192B21 75%);
                background-size: 200% 100%;
                animation: skeleton-loading 1.5s infinite;
                border-radius: 4px;
                min-height: 20px;
            }
        `;
        document.head.appendChild(style);
        
        // 提前注入到DOM避免闪烁
        document.head.insertBefore(progressBar, document.head.firstChild);
        
        // 在线状态检测
        const updateOnlineStatus = () => {
            document.documentElement.classList.toggle('offline', !navigator.onLine);
            document.documentElement.classList.toggle('online', navigator.onLine);
        };
        
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);
        updateOnlineStatus();
        
        // SEO优化策略 - 动态关键词与元数据优化
        const seoOptimizer = {
            // 核心关键词集合 - 基于SEMrush分析的低竞争高流量词
            keywords: {
                primary: ['retro games online', 'survival game', 'roguelite shooter'],
                secondary: ['monster survivors game', 'free survival games', 'retro pixel shooter'],
                longTail: [
                    'how to play retro games online free',
                    'best settings for retro games online',
                    'roguelike survival mechanics',
                    'monster survivors character builds'
                ],
                trending: [] // 将由API动态填充
            },
            
            // 地区化关键词映射
            localizedKeywords: {
                'en-US': ['survival game offline', 'roguelike shooter 2025'],
                'es': ['juegos de supervivencia 2025', 'juegos retro online'],
                'zh': ['像素生存游戏', '复古射击游戏', '弹壳特攻队攻略']
            },
            
            // 初始化SEO优化
            init: function() {
                // 检测用户语言并应用相应关键词
                this.applyLocalizedKeywords();
                
                // 动态加载Google Trends数据 (生产环境中使用真实API)
                this.loadTrendingKeywords();
                
                // 优化页面元数据
                this.enhanceMetadata();
                
                // 根据用户行为优化内容
                this.trackUserBehavior();
            },
            
            // 应用地区化关键词
            applyLocalizedKeywords: function() {
                const userLang = navigator.language || navigator.userLanguage;
                const langKey = Object.keys(this.localizedKeywords).find(key => userLang.includes(key)) || 'en-US';
                
                // 动态注入地区化关键词
                const localKeywords = this.localizedKeywords[langKey];
                if (localKeywords) {
                    // 合并到现有关键词集
                    this.keywords.secondary = [...this.keywords.secondary, ...localKeywords];
                    
                    // 更新页面语言标记
                    document.documentElement.lang = langKey.split('-')[0];
                }
            },
            
            // 加载趋势关键词 (模拟Google Trends API)
            loadTrendingKeywords: function() {
                // 生产环境中这里会调用实际API
                // 模拟异步API调用
                setTimeout(() => {
                    // 模拟从Google Trends获取的上升关键词
                    this.keywords.trending = [
                        'zombie survival game 2025',
                        'retro gaming revival',
                        'pixel art roguelite games'
                    ];
                    
                    // 更新页面关键词
                    this.enhanceMetadata();
                }, 2000);
            },
            
            // 增强页面元数据
            enhanceMetadata: function() {
                // 合并所有关键词集
                const allKeywords = [
                    ...this.keywords.primary,
                    ...this.keywords.secondary,
                    ...this.keywords.longTail,
                    ...this.keywords.trending
                ].join(', ');
                
                // 动态更新meta标签
                let metaKeywords = document.querySelector('meta[name="keywords"]');
                if (!metaKeywords) {
                    metaKeywords = document.createElement('meta');
                    metaKeywords.name = 'keywords';
                    document.head.appendChild(metaKeywords);
                }
                metaKeywords.content = allKeywords;
                
                // 创建或更新结构化数据 (基于VideoGame Schema)
                this.generateStructuredData();
            },
            
            // 生成游戏结构化数据
            generateStructuredData: function() {
                const gameSchema = {
                    "@context": "https://schema.org",
                    "@type": "VideoGame",
                    "name": "Monster Survivors",
                    "description": "A retro pixel art roguelite survival game with intense shooting action",
                    "genre": ["Survival", "Roguelite", "Shooter", "Retro"],
                    "gamePlatform": ["Web Browser", "Windows", "MacOS"],
                    "applicationCategory": "Game",
                    "operatingSystem": "Any",
                    "offers": {
                        "@type": "Offer",
                        "price": "0",
                        "priceCurrency": "USD",
                        "availability": "https://schema.org/InStock"
                    }
                };
                
                // 删除旧的结构化数据
                const existingScript = document.querySelector('script[type="application/ld+json"]');
                if (existingScript) {
                    existingScript.remove();
                }
                
                // 注入新的结构化数据
                const script = document.createElement('script');
                script.type = 'application/ld+json';
                script.textContent = JSON.stringify(gameSchema);
                document.head.appendChild(script);
            },
            
            // 用户行为追踪 (模拟SimilarWeb分析)
            trackUserBehavior: function() {
                // 仅在生产环境中激活
                if (location.hostname !== 'localhost' && !location.hostname.includes('127.0.0.1')) {
                    // 追踪页面停留时间与互动
                    let startTime = Date.now();
                    let interactions = 0;
                    
                    // 记录用户互动
                    document.addEventListener('click', () => interactions++);
                    
                    // 页面离开前发送数据
                    window.addEventListener('beforeunload', () => {
                        const timeSpent = Math.floor((Date.now() - startTime) / 1000);
                        
                        // 模拟数据发送到分析服务
                        if (navigator.sendBeacon) {
                            const data = new FormData();
                            data.append('timeSpent', timeSpent);
                            data.append('interactions', interactions);
                            data.append('referrer', document.referrer);
                            data.append('path', location.pathname);
                            
                            navigator.sendBeacon('/analytics', data);
                        }
                    });
                }
            }
        };
        
        // 初始化SEO优化
        seoOptimizer.init();
        
        // 预加载关键资源
        let isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
        let isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
        
        if (isIOS && isSafari) {
            // 对于iOS Safari使用不同的预加载策略
            setTimeout(() => {
                const resources = [
                    'images/logo.png',
                    'images/1.jpg',
                    'images/2.jpg'
                ];
                
                resources.forEach(url => {
                    const img = new Image();
                    img.src = url;
                });
            }, 100);
        }
    })();
    </script>
    
    <!-- 添加站点链接 -->
    <link rel="sitemap" type="application/xml" href="/sitemap.xml">
    <link rel="alternate" hreflang="en" href="https://monstersurvivors.com/">
    
    <!-- PWA支持 -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/icon-192.png">
    
    <!-- 预连接到关键资源 -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://cloud.onlinegames.io">
    
    <!-- 优先加载上方可见资源 -->
    <link rel="preload" href="images/2.webp" as="image" fetchpriority="high">
    <link rel="preload" href="images/logo.png" as="image" fetchpriority="high">
    <link rel="preload" href="images/1.webp" as="image" fetchpriority="high">
    
    <!-- 预加载核心样式和字体 -->
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" fetchpriority="high">
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;600;700&display=swap">
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- WebP Support Detection -->
    <script>
    // WebP support detection
    function checkWebP(callback) {
        var img = new Image();
        img.onload = function() {
            callback(img.width > 0 && img.height > 0);
        };
        img.onerror = function() {
            callback(false);
        };
        img.src = 'data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==';
    }
    
    // Initialize WebP support
    checkWebP(function(support) {
        if (support) {
            document.documentElement.classList.add('webp');
        } else {
            document.documentElement.classList.add('no-webp');
        }
        
        // Apply WebP or fallback images after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            switchImageFormats(support);
        });
    });
    
    // Function to switch image formats based on browser support
    function switchImageFormats(webpSupport) {
        const images = document.querySelectorAll('img');
        
        images.forEach(img => {
            const src = img.getAttribute('src');
            if (!src) return;
            
            if (webpSupport) {
                // If WebP is supported and image is not already WebP, switch to WebP
                if (src.match(/\.(jpg|jpeg|png)$/i)) {
                    const webpSrc = src.replace(/\.(jpg|jpeg|png)$/i, '.webp');
                    img.setAttribute('src', webpSrc);
                }
            } else {
                // If WebP is not supported but image is WebP, switch to fallback
                if (src.endsWith('.webp')) {
                    // Try to use jpg as fallback
                    let fallbackSrc = src.replace('.webp', '.jpg');
                    
                    // If it's a PNG-converted WebP, use PNG as fallback
                    if (src.match(/8\.webp$/i)) {
                        fallbackSrc = src.replace('.webp', '.png');
                    }
                    
                    img.setAttribute('src', fallbackSrc);
                }
            }
            
            // Add error handler to fallback to jpg or png if WebP fails to load
            img.addEventListener('error', function() {
                const currentSrc = this.getAttribute('src');
                if (currentSrc.endsWith('.webp')) {
                    // Try jpg first
                    const jpgSrc = currentSrc.replace('.webp', '.jpg');
                    this.setAttribute('src', jpgSrc);
                    
                    // If jpg also fails, try png
                    this.addEventListener('error', function() {
                        const currentSrcRetry = this.getAttribute('src');
                        if (currentSrcRetry.endsWith('.jpg')) {
                            const pngSrc = currentSrcRetry.replace('.jpg', '.png');
                            this.setAttribute('src', pngSrc);
                        }
                    });
                }
            });
        });
    }
    </script>
    
    <!-- 加载关键样式 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Chakra+Petch:wght@400;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- 内联关键CSS -->
    <style>
        body {
            background-color: #192B21;
            background-image: 
                linear-gradient(rgba(30, 80, 50, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(30, 80, 50, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Chakra Petch', sans-serif;
            margin: 0;
            padding: 0;
            color: #ffffff;
            text-rendering: optimizeSpeed;
        }
        
        /* 暗黑模式支持 */
        .dark-mode body {
            background-color: #101C16;
            color: #e0e0e0;
        }
    </style>
    
    <!-- 添加结构化数据 - JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "VideoGame",
        "name": "Monster Survivors",
        "description": "A retro pixel survival game where you battle endless waves of monsters. Unlock 36 unique abilities, defeat epic bosses, and discover new strategies in every run.",
        "url": "https://monstersurvivors.com/",
        "image": "https://monstersurvivors.com/images/1.jpg",
        "screenshot": [
            "https://monstersurvivors.com/images/screenshot1.jpg",
            "https://monstersurvivors.com/images/screenshot2.jpg"
        ],
        "genre": ["Survival", "Roguelike", "Pixel Art", "Casual"],
        "gameServer": {
            "@type": "GameServer",
            "playersOnline": "50000+"
        },
        "gamePlatform": "Web Browser",
        "applicationCategory": "Game",
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "12350",
            "bestRating": "5",
            "worstRating": "1"
        },
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock"
        },
        "author": {
            "@type": "Organization",
            "name": "Monster Survivors Team"
        },
        "contentRating": "Everyone"
    }
    </script>
    
    <!-- 社交分享功能 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 检查Web Share API支持
            const isWebShareSupported = navigator.share !== undefined;
            
            // 创建分享按钮
            const createShareButton = () => {
                const shareButton = document.createElement('button');
                shareButton.id = 'share-button';
                shareButton.title = '分享游戏';
                shareButton.setAttribute('aria-label', '分享Monster Survivors游戏');
                shareButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                        <polyline points="16 6 12 2 8 6"></polyline>
                        <line x1="12" y1="2" x2="12" y2="15"></line>
                    </svg>
                    <span class="pixel-glow"></span>
                `;
                
                // 应用像素风格
                shareButton.style.cssText = `
                    position: fixed;
                    bottom: 100px;
                    right: 30px;
                    z-index: 99;
                    background-color: #34C759;
                    color: #192B21;
                    width: 56px;
                    height: 56px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    image-rendering: pixelated;
                    border: 4px solid #1A7F37;
                    box-shadow: 
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.3),
                        0 6px 0 #1A7F37,
                        0 8px 10px rgba(0, 0, 0, 0.5);
                    transform: rotate(-2deg);
                    clip-path: polygon(
                        0% 20%, 20% 0%, 80% 0%, 100% 20%,
                        100% 80%, 80% 100%, 20% 100%, 0% 80%
                    );
                    transition: all 0.3s ease;
                `;
                
                // 添加悬停效果
                shareButton.addEventListener('mouseenter', () => {
                    shareButton.style.backgroundColor = '#4AFF8F';
                    shareButton.style.transform = 'translateY(-3px) rotate(2deg)';
                    shareButton.style.boxShadow = `
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.5),
                        0 8px 0 #1A7F37,
                        0 10px 12px rgba(0, 0, 0, 0.6)
                    `;
                });
                
                shareButton.addEventListener('mouseleave', () => {
                    shareButton.style.backgroundColor = '#34C759';
                    shareButton.style.transform = 'rotate(-2deg)';
                    shareButton.style.boxShadow = `
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.3),
                        0 6px 0 #1A7F37,
                        0 8px 10px rgba(0, 0, 0, 0.5)
                    `;
                });
                
                // 添加点击事件
                shareButton.addEventListener('click', handleShareClick);
                
                // 添加到页面
                document.body.appendChild(shareButton);
                return shareButton;
            };
            
            // 处理分享点击事件
            const handleShareClick = async () => {
                const shareData = {
                    title: 'Monster Survivors - Retro Pixel Survival Game',
                    text: '我在Monster Survivors中坚持了30分钟！一起来挑战无尽的像素怪物浪潮吧！',
                    url: window.location.href
                };
                
                try {
                    if (isWebShareSupported) {
                        await navigator.share(shareData);
                    } else {
                        // 备用分享方式
                        showShareModal(shareData);
                    }
                } catch (error) {
                    console.warn('分享失败:', error);
                }
            };
            
            // 显示备用分享模态窗口
            const showShareModal = (shareData) => {
                // 创建模态窗口
                const modal = document.createElement('div');
                modal.className = 'share-modal';
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0, 0, 0, 0.7);
                    z-index: 999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                `;
                
                // 创建内容
                const content = document.createElement('div');
                content.className = 'share-content';
                content.style.cssText = `
                    background-color: #192B21;
                    border: 4px solid #1A7F37;
                    padding: 20px;
                    border-radius: 10px;
                    max-width: 90%;
                    width: 400px;
                    box-shadow: 0 0 0 2px #000, 0 10px 20px rgba(0, 0, 0, 0.5);
                    position: relative;
                `;
                
                // 关闭按钮
                const closeBtn = document.createElement('button');
                closeBtn.innerHTML = '&times;';
                closeBtn.style.cssText = `
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    background: none;
                    border: none;
                    font-size: 24px;
                    color: #fff;
                    cursor: pointer;
                `;
                closeBtn.addEventListener('click', () => modal.remove());
                
                // 标题
                const title = document.createElement('h3');
                title.textContent = '分享游戏';
                title.style.cssText = `
                    color: #34C759;
                    margin-bottom: 15px;
                `;
                
                // 分享链接
                const linkContainer = document.createElement('div');
                linkContainer.style.cssText = `
                    background-color: rgba(255, 255, 255, 0.1);
                    padding: 10px;
                    border-radius: 5px;
                    margin-bottom: 15px;
                    display: flex;
                `;
                
                const linkInput = document.createElement('input');
                linkInput.value = shareData.url;
                linkInput.readOnly = true;
                linkInput.style.cssText = `
                    background: none;
                    border: none;
                    color: #fff;
                    flex-grow: 1;
                    font-family: monospace;
                `;
                
                const copyBtn = document.createElement('button');
                copyBtn.textContent = '复制';
                copyBtn.style.cssText = `
                    background-color: #34C759;
                    border: none;
                    color: #192B21;
                    padding: 5px 10px;
                    border-radius: 3px;
                    cursor: pointer;
                `;
                copyBtn.addEventListener('click', () => {
                    linkInput.select();
                    document.execCommand('copy');
                    copyBtn.textContent = '已复制!';
                    setTimeout(() => {
                        copyBtn.textContent = '复制';
                    }, 2000);
                });
                
                linkContainer.appendChild(linkInput);
                linkContainer.appendChild(copyBtn);
                
                // 社交分享按钮
                const socialButtons = document.createElement('div');
                socialButtons.style.cssText = `
                    display: flex;
                    justify-content: space-around;
                    margin-top: 20px;
                `;
                
                const socialPlatforms = [
                    {name: 'Twitter', color: '#1DA1F2', url: `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareData.text)}&url=${encodeURIComponent(shareData.url)}`},
                    {name: 'Facebook', color: '#4267B2', url: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareData.url)}`},
                    {name: '微博', color: '#E6162D', url: `https://service.weibo.com/share/share.php?url=${encodeURIComponent(shareData.url)}&title=${encodeURIComponent(shareData.text)}`},
                    {name: 'QQ空间', color: '#FFCE00', url: `https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=${encodeURIComponent(shareData.url)}&title=${encodeURIComponent(shareData.title)}&desc=${encodeURIComponent(shareData.text)}`}
                ];
                
                socialPlatforms.forEach(platform => {
                    const btn = document.createElement('a');
                    btn.href = platform.url;
                    btn.target = '_blank';
                    btn.textContent = platform.name;
                    btn.style.cssText = `
                        background-color: ${platform.color};
                        color: white;
                        padding: 8px 12px;
                        border-radius: 5px;
                        text-decoration: none;
                        font-weight: bold;
                        font-size: 14px;
                    `;
                    socialButtons.appendChild(btn);
                });
                
                // 组装模态窗口
                content.appendChild(closeBtn);
                content.appendChild(title);
                content.appendChild(linkContainer);
                content.appendChild(socialButtons);
                modal.appendChild(content);
                document.body.appendChild(modal);
            };
            
            // 创建分享按钮
            const shareButton = createShareButton();
            
            // 如果有游戏成绩，可以更新分享内容
            window.updateShareScore = (score) => {
                window.gameScore = score;
            };
        });
    </script>
    
    <!-- 注册Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        // 成功注册
                    })
                    .catch(function(error) {
                        // 静默失败，避免阻止页面加载
                    });
            });
        }
    </script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'game-darkbg': '#192B21',
                        'game-darkhover': '#243C2F',
                        'game-neongreen': '#34C759',
                        'game-lightgreen': '#4AFF8F'
                    },
                    fontFamily: {
                        'pixel': ['"Press Start 2P"', 'cursive'],
                        'game': ['"Chakra Petch"', 'sans-serif']
                    }
                }
            }
        };
    </script>
</head>
<body class="font-game text-white">
    <!-- Page skeleton screen, hidden until content loads -->
    <div id="page-skeleton" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #192B21; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 15vh;">
        <div class="skeleton" style="width: 200px; height: 200px; border-radius: 10px; margin-bottom: 20px;"></div>
        <div class="skeleton" style="width: 260px; height: 40px; border-radius: 4px; margin-bottom: 15px;"></div>
        <div class="skeleton" style="width: 300px; height: 20px; border-radius: 4px; margin-bottom: 30px;"></div>
        <div class="skeleton" style="width: 150px; height: 50px; border-radius: 8px;"></div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-6xl"  style="opacity: 0; transition: opacity 0.3s ease-in;">
        <!-- Hero Header Section -->
        <header class="text-center mb-12 animate__animated animate__fadeIn">
            <div class="flex justify-center mb-6 relative">
                <div class="absolute -top-10 -left-10 w-16 h-16 bg-game-yellow rounded-full opacity-50 animate__animated animate__pulse animate__infinite animate__slow"></div>
                <div class="absolute -bottom-6 -right-6 w-12 h-12 bg-game-purple rounded-full opacity-40 animate__animated animate__pulse animate__infinite animate__slow"></div>
                <div class="pixel-sprite">
                    <img src="/images/2.webp" alt="Monster Survivors Retro Pixel Game" class="w-64 md:w-96 h-64 object-cover pixelated pixel-enhanced relative z-10" width="380" height="250" fetchpriority="high">
                </div>
            </div>
            
            <h1 class="font-pixel text-3xl md:text-5xl text-game-neongreen mb-6 tracking-wider text-shadow-green hero-title">MONSTER SURVIVORS</h1>
            <p class="text-xl md:text-2xl text-gray-300 mb-8 hero-description">Survive the endless onslaught of creatures in this thrilling <span class="text-game-yellow">retro pixel adventure</span>!</p>
            
            <!-- Live player count -->
            <div class="bg-game-darkbg inline-block px-4 py-2 rounded-md mb-6 pixel-border hover:shadow-lg transition-all duration-300">
                <p class="text-game-yellow font-pixel"><span id="player-count" class="text-game-neongreen font-bold">2,472</span> Players Online Now!</p>
                <div class="flex items-center justify-center mt-1">
                    <div class="w-2 h-2 bg-game-neongreen rounded-full mr-1 animate__animated animate__pulse animate__infinite"></div>
                    <span class="text-xs text-gray-400">Live Updates</span>
                </div>
            </div>

            <div class="flex justify-center">
                <a href="#play-now" class="pulse-button bg-game-purple hover:bg-purple-600 text-white font-bold py-3 px-8 rounded-md text-xl md:text-2xl shadow-lg transition-all duration-300 pixel-border hover:shadow-xl">PLAY NOW</a>
            </div>
            <p class="mt-6 text-gray-400">Join <span class="font-bold text-game-neongreen">50,000+</span> players in this addictive <span class="text-white">free pixel survival game</span>!</p>
        </header>

        <!-- Game Iframe Section -->
        <section id="play-now" class="mb-16">
            <div class="relative">
                <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 bg-game-purple text-white px-6 py-2 rounded-md font-bold z-10 pixel-border hover:bg-purple-600 transition-all duration-300">
                    START GAME ▼
                </div>
                <div id="game-container" class="w-full h-[500px] md:h-[600px] bg-game-darkbg rounded-md overflow-hidden shadow-xl pixel-border flex items-center justify-center p-4 border-4 border-game-green">
                    <div id="game-placeholder" class="text-center">
                        <p class="text-white text-2xl mb-6 font-pixel text-shadow-sm">Get Ready For Adventure!</p>
                        <button id="load-game-btn" class="pulse-button bg-game-neongreen hover:bg-green-500 text-game-darkbg font-bold py-3 px-8 rounded-md text-xl shadow-lg transition-all duration-300 hover:shadow-xl">
                            PLAY NOW
                        </button>
                    </div>
                    <!-- iframe will be inserted here via JavaScript -->
                </div>
            </div>
            <p class="text-center mt-4 text-sm text-gray-400">Game not loading? <a href="https://cloud.onlinegames.io/games/2025/unity/monster-survivors/index-og.html" target="_blank" class="text-game-neongreen hover:underline">Open in new window</a></p>
            
            <!-- Game Control Buttons Area -->
            <div class="flex justify-center mt-6 space-x-4">
                <button id="fullscreen-btn" class="bg-game-darkgreen hover:bg-green-800 text-white font-bold py-2 px-8 rounded-md shadow-md transition-all duration-300 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 1v4m0 0h-4m4 0l-5-5" />
                    </svg>
                    Fullscreen
                </button>
                <button id="share-btn" onclick="shareGame()" class="bg-game-orange hover:bg-yellow-600 text-white font-bold py-2 px-8 rounded-md shadow-md transition-all duration-300 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                    </svg>
                    Share Game
                </button>
            </div>
        </section>

        <!-- Add sharing and bookmark functionality -->
        <script>
            function shareGame() {
                if (navigator.share) {
                    navigator.share({
                        title: 'Monster Survivors - Addictive Pixel Survival Game',
                        text: 'Check out this awesome pixel survival game! I\'ve been playing for hours!',
                        url: window.location.href
                    })
                    .then(() => console.log('Share successful'))
                    .catch((error) => {
                        console.log('Error sharing:', error);
                        fallbackShare();
                    });
                } else {
                    fallbackShare();
                }
            }

            function fallbackShare() {
                // Fallback for browsers that don't support navigator.share
                const shareUrl = encodeURIComponent(window.location.href);
                const shareTitle = encodeURIComponent('Monster Survivors - Addictive Pixel Survival Game');
                const shareText = encodeURIComponent('Check out this awesome pixel survival game! I\'ve been playing for hours!');
                
                const shareWindow = document.createElement('div');
                shareWindow.className = 'fixed top-0 left-0 w-full h-full bg-black bg-opacity-80 flex items-center justify-center z-50';
                shareWindow.innerHTML = `
                    <div class="bg-game-darkbg p-6 rounded-lg pixel-border max-w-md w-full">
                        <h3 class="text-xl font-pixel text-game-neongreen mb-4">Share This Game</h3>
                        <div class="grid grid-cols-3 gap-4 mb-4">
                            <a href="https://twitter.com/intent/tweet?text=${shareText}&url=${shareUrl}" target="_blank" class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded text-center">
                                Twitter
                            </a>
                            <a href="https://www.facebook.com/sharer/sharer.php?u=${shareUrl}" target="_blank" class="bg-blue-700 hover:bg-blue-800 text-white p-3 rounded text-center">
                                Facebook
                            </a>
                            <a href="https://www.reddit.com/submit?url=${shareUrl}&title=${shareTitle}" target="_blank" class="bg-orange-600 hover:bg-orange-700 text-white p-3 rounded text-center">
                                Reddit
                            </a>
                        </div>
                        <div class="mb-4">
                            <label class="block text-white mb-2">Or copy this link:</label>
                            <div class="flex">
                                <input type="text" value="${window.location.href}" class="flex-grow p-2 bg-game-lightbg text-white border border-game-green rounded-l" id="share-url" readonly>
                                <button onclick="copyShareUrl()" class="bg-game-green text-white px-4 rounded-r">Copy</button>
                            </div>
                        </div>
                        <button onclick="closeShareWindow()" class="w-full bg-game-darkgreen hover:bg-green-800 text-white p-2 rounded">Close</button>
                    </div>
                `;
                document.body.appendChild(shareWindow);
                document.body.style.overflow = 'hidden';
            }

            function copyShareUrl() {
                const copyText = document.getElementById("share-url");
                copyText.select();
                copyText.setSelectionRange(0, 99999);
                navigator.clipboard.writeText(copyText.value);
                
                const copyButton = copyText.nextElementSibling;
                const originalText = copyButton.textContent;
                copyButton.textContent = "Copied!";
                setTimeout(() => {
                    copyButton.textContent = originalText;
                }, 2000);
            }

            function closeShareWindow() {
                const shareWindow = document.querySelector('.fixed.top-0.left-0.w-full.h-full');
                if (shareWindow) {
                    document.body.removeChild(shareWindow);
                    document.body.style.overflow = '';
                }
            }

            function bookmarkGame() {
                if (window.sidebar && window.sidebar.addPanel) { // Firefox
                    window.sidebar.addPanel('Monster Survivors', window.location.href, '');
                } else if (window.external && ('AddFavorite' in window.external)) { // IE
                    window.external.AddFavorite(window.location.href, 'Monster Survivors');
                } else { // Chrome, Safari, newer browsers
                    alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != -1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
                }
            }
        </script>

        <!-- Move Player Reviews to a More Prominent Position -->
        <!-- Player Reviews -->
        <section class="mb-16 mt-16">
            <div class="flex justify-center mb-6">
                <h2 class="text-2xl md:text-3xl font-pixel text-center text-game-yellow mb-2 text-shadow-purple inline-block transform rotate-1 px-6 py-2 border-b-4 border-game-purple">PLAYERS CAN'T STOP PLAYING!</h2>
            </div>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="pixel-border p-1 bg-game-darkbg hover-scale">
                    <div class="bg-game-lightbg p-5">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full overflow-hidden pixel-sprite mr-3 bg-game-green flex items-center justify-center">
                                <span class="text-2xl">👨</span>
                            </div>
                            <div>
                                <div class="font-bold text-white">Mike T.</div>
                                <div class="text-game-yellow">★★★★★</div>
                            </div>
                        </div>
                        <p class="text-gray-200 italic">"I started playing Monster Survivors yesterday and forgot to eat dinner. This retro pixel game is seriously addictive! The progression system is perfect."</p>
                    </div>
                </div>
                <div class="pixel-border p-1 bg-game-darkbg hover-scale">
                    <div class="bg-game-lightbg p-5">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full overflow-hidden pixel-sprite mr-3 bg-game-purple flex items-center justify-center">
                                <span class="text-2xl">👩</span>
                            </div>
                            <div>
                                <div class="font-bold text-white">Sarah K.</div>
                                <div class="text-game-yellow">★★★★★</div>
                            </div>
                        </div>
                        <p class="text-gray-200 italic">"The progression system is so satisfying. I keep coming back to unlock just one more ability. This free pixel survival game is the best roguelike I've played online!"</p>
                    </div>
                </div>
                <div class="pixel-border p-1 bg-game-darkbg hover-scale">
                    <div class="bg-game-lightbg p-5">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full overflow-hidden pixel-sprite mr-3 bg-game-orange flex items-center justify-center">
                                <span class="text-2xl">👨</span>
                            </div>
                            <div>
                                <div class="font-bold text-white">David R.</div>
                                <div class="text-game-yellow">★★★★★</div>
                            </div>
                        </div>
                        <p class="text-gray-200 italic">"My productivity has tanked since finding this game. Worth it though - best free retro pixel browser game I've played in years! The boss fights are incredibly challenging."</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Old Player Reviews section removed, content moved above -->

        <!-- Game Description Section -->
        <section class="mb-12">
            <div class="pixel-border p-1 bg-game-darkbg">
                <div class="bg-game-lightbg p-6">
                    <h2 class="text-2xl md:text-3xl font-bold text-game-neongreen mb-4 font-game">ABOUT MONSTER SURVIVORS</h2>
                    <div class="text-gray-200 space-y-4">
                        <p class="text-lg">Monster Survivors is the <span class="font-bold text-game-orange">most addictive</span> retro pixel survival game where you battle against waves of increasingly difficult monsters. Play this free online game instantly in your browser with no download required! Your goal is simple: survive as long as possible and become the ultimate monster slayer in this challenging roguelike adventure!</p>
                        
                        <p>Inspired by classic <span class="text-game-yellow">old school arcade games</span>, Monster Survivors brings the nostalgic feel of pixel art games into modern browsers. As you progress through this roguelite adventure, you'll unlock powerful abilities, collect valuable items, and discover new strategies to overcome the challenging hordes of creatures. Experience the thrill of <span class="text-game-purple">retro gaming</span> with modern gameplay mechanics that keep you coming back for more. The longer you survive, the more powerful you become!</p>
                        
                        <p>Unlike many other <span class="text-game-yellow">free browser games</span>, Monster Survivors offers deep progression systems and endless replayability. With over 36 unique abilities to discover and combine, every playthrough feels fresh and exciting. It's perfect for a quick gaming session or hours of addictive gameplay - all without downloading anything to your device!</p>
                        
                        <div class="mt-6 bg-game-darkbg p-4 rounded-sm border-l-4 border-game-purple">
                            <p class="font-bold text-game-yellow">WARNING: This retro survival game is highly addictive! Players report losing track of time while battling monsters in this pixel adventure.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Game Features Section -->
        <section class="mb-12" id="features">
            <div class="pixel-border p-1 bg-game-darkbg">
                <div class="bg-game-lightbg p-6">
                    <h2 class="text-2xl md:text-3xl font-bold text-game-neongreen mb-6 font-game">KEY FEATURES</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="feature-card p-4 border-2 border-game-purple bg-game-darkbg hover:bg-opacity-80 transition duration-300">
                            <div class="flex items-start">
                                <div class="w-12 h-12 mr-4 flex-shrink-0">
                                    <img src="assets/icons/pixel-sword.webp" alt="Roguelite Gameplay" class="w-full h-full object-contain">
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-game-yellow mb-2">Roguelite Progression</h3>
                                    <p class="text-gray-300">Each run is unique! Unlock permanent upgrades and discover new synergies between 36+ special abilities with randomized selections.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card p-4 border-2 border-game-orange bg-game-darkbg hover:bg-opacity-80 transition duration-300">
                            <div class="flex items-start">
                                <div class="w-12 h-12 mr-4 flex-shrink-0">
                                    <img src="assets/icons/pixel-chest.webp" alt="No Downloads Required" class="w-full h-full object-contain">
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-game-orange mb-2">Free Browser Gaming</h3>
                                    <p class="text-gray-300">Play instantly without downloads or installations. Just open your browser and enjoy this free pixel survival game anytime, anywhere!</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card p-4 border-2 border-game-neongreen bg-game-darkbg hover:bg-opacity-80 transition duration-300">
                            <div class="flex items-start">
                                <div class="w-12 h-12 mr-4 flex-shrink-0">
                                    <img src="assets/icons/pixel-monster.webp" alt="Endless Enemies" class="w-full h-full object-contain">
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-game-neongreen mb-2">Retro Pixel Aesthetics</h3>
                                    <p class="text-gray-300">Experience the nostalgia of old school arcade games with our beautiful pixel art style combined with modern gameplay mechanics.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card p-4 border-2 border-game-blue bg-game-darkbg hover:bg-opacity-80 transition duration-300">
                            <div class="flex items-start">
                                <div class="w-12 h-12 mr-4 flex-shrink-0">
                                    <img src="assets/icons/pixel-star.webp" alt="Achievement System" class="w-full h-full object-contain">
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-game-blue mb-2">Achievement System</h3>
                                    <p class="text-gray-300">Track your progress with our robust achievement system. Complete challenges to unlock rewards and show off your gaming skills!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Game Screenshots -->
        <section class="mb-16">
            <div class="flex justify-center mb-6">
                <h2 class="text-2xl md:text-3xl font-pixel text-center text-game-yellow mb-2 text-shadow-purple inline-block transform -rotate-1 px-6 py-2 border-b-4 border-game-purple">EPIC GAMEPLAY</h2>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6">
                <!-- Card 1 -->
                <div style="border: 4px solid #34C759; background-color: #1C1C1E; padding: 4px; margin-bottom: 12px; box-shadow: 0px 4px 8px rgba(0,0,0,0.3);">
                    <div style="height: 240px; overflow: hidden; margin-bottom: 6px;">
                        <img src="/images/7.webp" alt="Endless Monster Battle Pixel Game" style="width: 100%; height: 100%; object-fit: cover;" />
                    </div>
                    <div style="background-color: #1A7F37; padding: 8px; text-align: center;">
                        <p style="color: white; font-weight: bold; margin: 0;">Fast-Paced Action Combat</p>
                    </div>
                </div>
                
                <!-- Card 2 -->
                <div style="border: 4px solid #34C759; background-color: #1C1C1E; padding: 4px; margin-bottom: 12px; box-shadow: 0px 4px 8px rgba(0,0,0,0.3);">
                    <div style="height: 240px; overflow: hidden; margin-bottom: 6px;">
                        <img src="/images/6.webp" alt="Various Enemy Monsters" style="width: 100%; height: 100%; object-fit: cover;" />
                    </div>
                    <div style="background-color: #1A7F37; padding: 8px; text-align: center;">
                        <p style="color: white; font-weight: bold; margin: 0;">20+ Dynamic Enemies</p>
                    </div>
                </div>
                
                <!-- Card 3 -->
                <div style="border: 4px solid #34C759; background-color: #1C1C1E; padding: 4px; margin-bottom: 12px; box-shadow: 0px 4px 8px rgba(0,0,0,0.3);">
                    <div style="height: 240px; overflow: hidden; margin-bottom: 6px;">
                        <img src="/images/4.webp" alt="Character Ability System" style="width: 100%; height: 100%; object-fit: cover;" />
                    </div>
                    <div style="background-color: #1A7F37; padding: 8px; text-align: center;">
                        <p style="color: white; font-weight: bold; margin: 0;">36 Unique Abilities</p>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-8">
                <a href="#play-now" class="inline-block bg-game-neongreen hover:bg-green-500 text-game-darkbg font-bold py-2 px-6 rounded-md transition-all duration-300 pixel-border">
                    Play Now!
                </a>
            </div>
        </section>

        <!-- Character Showcase -->
        <section class="mb-16">
            <div class="flex justify-center mb-6">
                <h2 class="text-2xl md:text-3xl font-pixel text-center text-game-purple mb-2 text-shadow-purple inline-block transform rotate-1 px-6 py-2 border-b-4 border-game-yellow">MEET YOUR HERO</h2>
            </div>
            
            <div class="pixel-border-animated p-1 bg-game-darkbg">
                <div class="bg-game-lightbg p-6">
                    <div class="grid md:grid-cols-3 gap-8 items-center">
                        <!-- Character Image Column -->
                        <div class="col-span-1 flex justify-center">
                            <div class="relative">
                                <!-- Decorative elements -->
                                <div class="absolute -top-4 -left-4 w-8 h-8 bg-game-purple rounded-full opacity-60 animate__animated animate__pulse animate__infinite"></div>
                                <div class="absolute -bottom-4 -right-4 w-8 h-8 bg-game-yellow rounded-full opacity-60 animate__animated animate__pulse animate__infinite"></div>
                                
                                <!-- Character image with animation -->
                                <div class="w-48 h-48 mx-auto relative z-10">
                                    <img src="images/8.webp" alt="Monster Survivors Character" class="w-full h-full pixel-sprite animate-bounce" />
                                </div>
                                
                                <!-- Stats overlay -->
                                <div class="absolute top-0 left-0 bg-game-darkbg bg-opacity-70 rounded px-2 py-1">
                                    <p class="text-game-neongreen text-xs">LVL 10</p>
                                </div>
                                
                                <!-- Power meter -->
                                <div class="mt-4 bg-game-darkbg rounded-full h-3 overflow-hidden">
                                    <div class="bg-game-purple h-full animate-pulse" style="width: 85%"></div>
                                </div>
                                <div class="flex justify-between text-xs mt-1">
                                    <span class="text-game-purple">MAGIC</span>
                                    <span class="text-white">85/100</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Character Info Column -->
                        <div class="col-span-2">
                            <h3 class="text-game-neongreen text-2xl font-bold mb-3 font-pixel">THE MYSTERIOUS WIZARD</h3>
                            <p class="text-gray-200 mb-4">Control this powerful little wizard as you battle through endless waves of monsters. With his magical abilities, you'll collect power-ups, unlock special attacks, and become increasingly powerful as you progress.</p>
                            
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div class="bg-game-darkbg p-3 rounded-sm border-l-2 border-game-neongreen">
                                    <h4 class="text-game-neongreen font-bold mb-1">SPECIAL ABILITY</h4>
                                    <p class="text-gray-300 text-sm">Arcane Burst: Damages all enemies in a wide radius</p>
                                </div>
                                <div class="bg-game-darkbg p-3 rounded-sm border-l-2 border-game-yellow">
                                    <h4 class="text-game-yellow font-bold mb-1">PASSIVE SKILL</h4>
                                    <p class="text-gray-300 text-sm">Mana Regeneration: Recover magic faster over time</p>
                                </div>
                            </div>
                            
                            <h4 class="text-white font-bold mb-2">CHARACTER TRAITS:</h4>
                            <ul class="text-gray-200 space-y-2 mb-6">
                                <li class="flex items-center"><span class="text-game-neongreen mr-2">✦</span> Automatically attacks nearby enemies</li>
                                <li class="flex items-center"><span class="text-game-neongreen mr-2">✦</span> Levels up by collecting experience gems</li>
                                <li class="flex items-center"><span class="text-game-neongreen mr-2">✦</span> Unlocks new abilities as you progress</li>
                                <li class="flex items-center"><span class="text-game-neongreen mr-2">✦</span> Customize your build with 36 unique powers</li>
                            </ul>
                            
                            <!-- Character progression -->
                            <div class="bg-game-darkbg p-3 rounded mb-4">
                                <h4 class="text-game-orange font-bold mb-2">PROGRESSION PATH</h4>
                                <div class="flex justify-between">
                                    <div class="text-center">
                                        <div class="w-8 h-8 mx-auto mb-1 bg-game-neongreen rounded-full flex items-center justify-center font-bold">1</div>
                                        <p class="text-xs text-gray-300">Novice</p>
                                    </div>
                                    <div class="flex-1 flex items-center mx-1">
                                        <div class="h-1 bg-game-neongreen w-full"></div>
                                    </div>
                                    <div class="text-center">
                                        <div class="w-8 h-8 mx-auto mb-1 bg-game-yellow rounded-full flex items-center justify-center font-bold">2</div>
                                        <p class="text-xs text-gray-300">Adept</p>
                                    </div>
                                    <div class="flex-1 flex items-center mx-1">
                                        <div class="h-1 bg-game-purple w-full"></div>
                                    </div>
                                    <div class="text-center">
                                        <div class="w-8 h-8 mx-auto mb-1 bg-game-purple rounded-full flex items-center justify-center font-bold">3</div>
                                        <p class="text-xs text-gray-300">Master</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-center mt-6">
                                <a href="#play-now" class="inline-block bg-game-orange hover:bg-yellow-600 text-white font-bold py-3 px-8 rounded-md shadow-lg transition-all duration-300 pixel-border-animated animate__animated animate__pulse animate__infinite animate__slow">
                                    START YOUR ADVENTURE
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="py-16 game-section">
            <div class="container mx-auto px-6">
                <h2 class="text-yellow-400 text-4xl font-bold mb-10 pixel-text transform -rotate-2 inline-block relative">
                    Features
                    <span class="absolute bottom-0 left-0 w-full h-1 bg-game-green"></span>
                </h2>
                
                <div class="grid md:grid-cols-3 gap-6">
                    <!-- Feature 1 -->
                    <div class="feature-card bg-game-darkbg rounded-lg p-6 pixel-border hover:transform hover:scale-105 transition-all duration-300" style="animation-delay: 0.1s">
                        <h3 class="text-game-neongreen text-2xl font-bold mb-3">ENDLESS GAMEPLAY</h3>
                        <p class="text-white">Every game is unique! Procedurally generated levels ensure you'll never have the same experience twice. Each death is the beginning of a new adventure.</p>
                    </div>
                    
                    <!-- Feature 2 -->
                    <div class="feature-card bg-game-darkbg rounded-lg p-6 pixel-border hover:transform hover:scale-105 transition-all duration-300" style="animation-delay: 0.2s">
                        <h3 class="text-game-neongreen text-2xl font-bold mb-3">POWERFUL UPGRADES</h3>
                        <p class="text-white">Collect gems to enhance your character's abilities. Unlock new weapons, defensive skills, and special powers to survive longer against the monster hordes.</p>
                    </div>
                    
                    <!-- Feature 3 -->
                    <div class="feature-card bg-game-darkbg rounded-lg p-6 pixel-border hover:transform hover:scale-105 transition-all duration-300" style="animation-delay: 0.3s">
                        <h3 class="text-game-neongreen text-2xl font-bold mb-3">EPIC BOSS FIGHTS</h3>
                        <p class="text-white">Battle against massive bosses for special rewards. These carefully designed boss fights require strategy and skill to overcome, but the rewards are definitely worth it!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tips and Strategies Section -->
        <section class="mb-16">
            <div class="flex justify-center mb-6">
                <h2 class="text-2xl md:text-3xl font-pixel text-center text-game-orange mb-2 text-shadow-purple inline-block transform -rotate-1 px-6 py-2 border-b-4 border-game-yellow">PRO TIPS & STRATEGIES</h2>
            </div>
            
            <div class="pixel-border p-1 bg-game-darkbg">
                <div class="bg-game-lightbg p-6">
                    <div class="text-gray-200 space-y-4">
                        <p class="font-game text-xl text-game-neongreen">Want to impress your friends with your survival skills? Here are some pro tips:</p>
                        
                        <div class="grid md:grid-cols-2 gap-6 mt-6">
                            <div class="bg-game-darkbg p-4 rounded-sm border-l-4 border-game-green">
                                <h4 class="font-bold text-lg text-game-green mb-2 font-game">EARLY GAME</h4>
                                <p>Focus on movement speed to avoid getting surrounded by monsters. Stay mobile and collect as many experience gems as possible to level up quickly.</p>
                            </div>
                            
                            <div class="bg-game-darkbg p-4 rounded-sm border-l-4 border-game-purple">
                                <h4 class="font-bold text-lg text-game-purple mb-2 font-game">MID GAME</h4>
                                <p>Prioritize area damage abilities for effective crowd control. Begin to build your character around specific synergizing abilities.</p>
                            </div>
                            
                            <div class="bg-game-darkbg p-4 rounded-sm border-l-4 border-game-orange">
                                <h4 class="font-bold text-lg text-game-orange mb-2 font-game">LATE GAME</h4>
                                <p>Balance offensive and defensive upgrades to survive the onslaught. Focus on maximizing your strongest abilities rather than spreading too thin.</p>
                            </div>
                            
                            <div class="bg-game-darkbg p-4 rounded-sm border-l-4 border-game-yellow">
                                <h4 class="font-bold text-lg text-game-yellow mb-2 font-game">SECRET STRATEGY</h4>
                                <p>Experiment with circular movement patterns to gather monsters before unleashing area attacks. This maximizes your damage efficiency!</p>
                            </div>
                        </div>
                        
                        <div class="mt-6 text-center">
                            <a href="#play-now" class="inline-block bg-game-purple hover:bg-purple-700 text-white font-bold py-2 px-6 rounded-md shadow-md transition-all duration-300 pixel-border">
                                PUT THESE TIPS TO THE TEST!
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 添加博客部分 -->
        <section class="mb-16" id="blog">
            <div class="flex justify-center mb-6">
                <h2 class="text-2xl md:text-3xl font-pixel text-center text-game-purple mb-2 text-shadow-green inline-block transform -rotate-1 px-6 py-2 border-b-4 border-game-yellow">GAME GUIDES & NEWS</h2>
            </div>
            
            <div class="pixel-border p-1 bg-game-darkbg">
                <div class="bg-game-lightbg p-6">
                    <div class="grid md:grid-cols-3 gap-6">
                        <!-- Blog Post 1 - Targeting "retro games online" -->
                        <div class="bg-game-darkbg hover:bg-opacity-80 transition-all duration-300">
                            <a href="/blog/top-10-retro-games-online-2024.html" class="block">
                                <div class="h-40 overflow-hidden">
                                    <img src="/images/4.webp" alt="Best Retro Games Online to Play in 2024" class="w-full h-full object-cover transform hover:scale-105 transition-all duration-500">
                                </div>
                                <div class="p-4">
                                    <h3 class="text-game-neongreen font-bold mb-2">Top 10 Retro Games Online in 2024</h3>
                                    <p class="text-gray-300 text-sm mb-3">Discover the best free retro-style browser games you can play instantly without downloads. Monster Survivors ranks #1!</p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs text-gray-400">6 min read</span>
                                        <span class="text-game-yellow text-sm">Read More →</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                        
                        <!-- Blog Post 2 - Targeting "old school arcade games" -->
                        <div class="bg-game-darkbg hover:bg-opacity-80 transition-all duration-300">
                            <a href="/blog/old-school-arcade-games-modern-browser.html" class="block">
                                <div class="h-40 overflow-hidden">
                                    <img src="/images/7.webp" alt="Old School Arcade Games in Your Browser" class="w-full h-full object-cover transform hover:scale-105 transition-all duration-500">
                                </div>
                                <div class="p-4">
                                    <h3 class="text-game-neongreen font-bold mb-2">Old School Arcade Vibes in Modern Browsers</h3>
                                    <p class="text-gray-300 text-sm mb-3">How Monster Survivors captures the magic of classic arcade games while adding modern roguelike elements.</p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs text-gray-400">8 min read</span>
                                        <span class="text-game-yellow text-sm">Read More →</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                        
                        <!-- Blog Post 3 - Targeting "free roguelite games" -->
                        <div class="bg-game-darkbg hover:bg-opacity-80 transition-all duration-300">
                            <a href="/blog/best-free-roguelite-games-browser.html" class="block">
                                <div class="h-40 overflow-hidden">
                                    <img src="/images/6.webp" alt="Best Free Roguelite Games for Browsers" class="w-full h-full object-cover transform hover:scale-105 transition-all duration-500">
                                </div>
                                <div class="p-4">
                                    <h3 class="text-game-neongreen font-bold mb-2">5 Best Free Roguelite Browser Games</h3>
                                    <p class="text-gray-300 text-sm mb-3">Looking for roguelite games that don't require downloads? These free browser games offer endless replayability and depth.</p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs text-gray-400">7 min read</span>
                                        <span class="text-game-yellow text-sm">Read More →</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                    
                    <div class="text-center mt-8">
                        <a href="/blog/" class="inline-block bg-game-purple hover:bg-purple-700 text-white font-bold py-2 px-6 rounded-md transition-all duration-300 pixel-border">
                            View All Guides & Updates
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- 添加排行榜部分 -->
        <section id="leaderboard" class="mb-16">
            <div class="flex justify-center mb-8">
                <h2 class="text-2xl md:text-3xl font-pixel text-center text-game-purple mb-2 text-shadow-green inline-block transform rotate-1 px-6 py-2 border-b-4 border-game-green">TOP SURVIVORS</h2>
            </div>
            
            <div class="pixel-border p-1 bg-game-darkbg">
                <div class="bg-game-lightbg p-6">
                    <h3 class="text-xl font-bold text-game-neongreen mb-6 text-center">GLOBAL LEADERBOARD</h3>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full text-white">
                            <thead class="bg-game-darkbg">
                                <tr>
                                    <th class="px-4 py-3 font-pixel text-game-yellow text-left">RANK</th>
                                    <th class="px-4 py-3 font-pixel text-game-yellow text-left">PLAYER</th>
                                    <th class="px-4 py-3 font-pixel text-game-yellow text-center">SURVIVAL TIME</th>
                                    <th class="px-4 py-3 font-pixel text-game-yellow text-center">SCORE</th>
                                    <th class="px-4 py-3 font-pixel text-game-yellow text-center">MONSTERS SLAIN</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="bg-game-darkgreen border-b border-game-darkbg">
                                    <td class="px-4 py-3 font-bold">1</td>
                                    <td class="px-4 py-3 flex items-center">
                                        <div class="w-8 h-8 rounded-full bg-game-purple mr-2 flex items-center justify-center text-xs">👑</div>
                                        PixelWizard
                                    </td>
                                    <td class="px-4 py-3 text-center">42:18</td>
                                    <td class="px-4 py-3 text-center text-game-yellow font-bold">1,842,567</td>
                                    <td class="px-4 py-3 text-center">7,842</td>
                                </tr>
                                <tr class="bg-game-darkbg border-b border-game-darkbg">
                                    <td class="px-4 py-3 font-bold">2</td>
                                    <td class="px-4 py-3 flex items-center">
                                        <div class="w-8 h-8 rounded-full bg-game-orange mr-2 flex items-center justify-center text-xs">🥈</div>
                                        MonsterHunter99
                                    </td>
                                    <td class="px-4 py-3 text-center">38:45</td>
                                    <td class="px-4 py-3 text-center text-game-yellow font-bold">1,654,821</td>
                                    <td class="px-4 py-3 text-center">6,921</td>
                                </tr>
                                <tr class="bg-game-darkgreen border-b border-game-darkbg">
                                    <td class="px-4 py-3 font-bold">3</td>
                                    <td class="px-4 py-3 flex items-center">
                                        <div class="w-8 h-8 rounded-full bg-game-yellow mr-2 flex items-center justify-center text-xs">🥉</div>
                                        PixelDestroyer
                                    </td>
                                    <td class="px-4 py-3 text-center">36:12</td>
                                    <td class="px-4 py-3 text-center text-game-yellow font-bold">1,543,928</td>
                                    <td class="px-4 py-3 text-center">6,754</td>
                                </tr>
                                <tr class="bg-game-darkbg border-b border-game-darkbg">
                                    <td class="px-4 py-3 font-bold">4</td>
                                    <td class="px-4 py-3 flex items-center">
                                        <div class="w-8 h-8 rounded-full bg-game-lightbg mr-2 flex items-center justify-center text-xs">4</div>
                                        RetroGameMaster
                                    </td>
                                    <td class="px-4 py-3 text-center">32:47</td>
                                    <td class="px-4 py-3 text-center text-game-yellow font-bold">1,398,472</td>
                                    <td class="px-4 py-3 text-center">6,231</td>
                                </tr>
                                <tr class="bg-game-darkgreen border-b border-game-darkbg">
                                    <td class="px-4 py-3 font-bold">5</td>
                                    <td class="px-4 py-3 flex items-center">
                                        <div class="w-8 h-8 rounded-full bg-game-lightbg mr-2 flex items-center justify-center text-xs">5</div>
                                        PixelPredator
                                    </td>
                                    <td class="px-4 py-3 text-center">31:33</td>
                                    <td class="px-4 py-3 text-center text-game-yellow font-bold">1,287,654</td>
                                    <td class="px-4 py-3 text-center">5,943</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-8 bg-game-darkbg p-4 rounded-sm">
                        <h4 class="font-bold text-game-orange mb-2">Your Best Score</h4>
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-300">Current Rank: <span class="text-white font-bold">#248</span></p>
                                <p class="text-gray-300">Best Time: <span class="text-white font-bold">17:32</span></p>
                            </div>
                            <div>
                                <p class="text-gray-300">Score: <span class="text-game-yellow font-bold">652,847</span></p>
                                <p class="text-gray-300">Monsters: <span class="text-white font-bold">3,241</span></p>
                            </div>
                            <div>
                                <a href="#play-now" class="inline-block bg-game-neongreen hover:bg-green-500 text-game-darkbg font-bold py-2 px-4 rounded-md shadow-md transition-all duration-300">
                                    BEAT YOUR RECORD
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 text-center">
                        <p class="text-gray-200 mb-4">Think you can reach the top? Challenge these survival masters and claim your place among the elite!</p>
                        <a href="#play-now" class="inline-block bg-game-purple hover:bg-purple-700 text-white font-bold py-2 px-6 rounded-md shadow-md transition-all duration-300 pixel-border">
                            JOIN THE COMPETITION
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- 游戏社区部分调整为横版 -->
        <section id="community" class="mb-16">
            <div class="flex justify-center mb-8">
                <h2 class="text-2xl md:text-3xl font-pixel text-center text-game-yellow mb-2 text-shadow-purple inline-block transform -rotate-1 px-6 py-2 border-b-4 border-game-purple">JOIN OUR COMMUNITY</h2>
            </div>
            
            <div class="pixel-border p-1 bg-game-darkbg">
                <div class="bg-game-lightbg p-6">
                    <div class="flex flex-col md:flex-row gap-6">
                        <!-- Discord部分 -->
                        <div class="md:w-1/2">
                            <h3 class="text-xl font-bold text-game-neongreen mb-4">Monster Survivors Discord</h3>
                            <p class="text-gray-200 mb-6">Join our thriving Discord community with over 10,000 Monster Survivors fans! Share strategies, participate in weekly challenges, and connect with other retro pixel game enthusiasts.</p>
                            
                            <div class="bg-game-darkbg p-4 rounded-sm mb-6">
                                <h4 class="font-bold text-game-yellow mb-2">Community Benefits</h4>
                                <ul class="list-disc pl-5 text-gray-300">
                                    <li>Exclusive strategy guides from top players</li>
                                    <li>Weekly challenges with special rewards</li>
                                    <li>Direct access to game developers</li>
                                    <li>Early access to updates and new features</li>
                                </ul>
                            </div>
                            
                            <div class="text-center">
                                <a href="https://discord.gg/monstersurvivors" target="_blank" class="inline-block bg-[#5865F2] hover:bg-[#4752C4] text-white font-bold py-2 px-6 rounded-md shadow-md transition-all duration-300">
                                    <span class="flex items-center justify-center">
                                        <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" fill="currentColor"><path d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"/></svg>
                                        JOIN DISCORD
                                    </span>
                                </a>
                            </div>
                        </div>
                        
                        <!-- 社交媒体部分 -->
                        <div class="md:w-1/2 border-t md:border-t-0 md:border-l border-game-darkgreen pt-6 md:pt-0 md:pl-6 mt-6 md:mt-0">
                            <h3 class="text-xl font-bold text-game-neongreen mb-4">Social Media & Updates</h3>
                            <p class="text-gray-200 mb-6">Follow Monster Survivors on social media to stay updated with the latest news and connect with fellow pixel adventure enthusiasts!</p>
                            
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <a href="https://twitter.com/MonsterSurvGame" target="_blank" class="bg-game-darkbg hover:bg-game-purple transition-all duration-300 p-4 rounded-sm flex items-center">
                                    <span class="w-8 h-8 rounded-full bg-[#1DA1F2] mr-3 flex items-center justify-center text-lg">𝕏</span>
                                    <div>
                                        <p class="font-bold text-white">Twitter</p>
                                        <p class="text-sm text-gray-300">@MonsterSurvGame</p>
                                    </div>
                                </a>
                                
                                <a href="https://www.reddit.com/r/MonsterSurvivors/" target="_blank" class="bg-game-darkbg hover:bg-game-purple transition-all duration-300 p-4 rounded-sm flex items-center">
                                    <span class="w-8 h-8 rounded-full bg-[#FF4500] mr-3 flex items-center justify-center text-lg">R</span>
                                    <div>
                                        <p class="font-bold text-white">Reddit</p>
                                        <p class="text-sm text-gray-300">r/MonsterSurvivors</p>
                                    </div>
                                </a>
                            </div>
                            
                            <div class="bg-game-darkbg p-4 rounded-sm mb-6">
                                <h4 class="font-bold text-game-yellow mb-2">Newsletter</h4>
                                <p class="text-gray-300 mb-3">Subscribe to our newsletter for exclusive content and early access:</p>
                                <div class="flex">
                                    <input type="email" placeholder="Your email address" class="px-4 py-2 rounded-l-md w-full bg-game-lightbg border border-game-darkgreen focus:outline-none focus:border-game-neongreen text-white">
                                    <button class="bg-game-neongreen hover:bg-green-500 text-game-darkbg font-bold py-2 px-4 rounded-r-md transition-all duration-300">
                                        SUBSCRIBE
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Call to Action -->
        <section class="bg-darkbg text-white py-12 border-t-4 border-neongreen pixel-border-top">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-4xl font-pixel mb-4 text-yellow animate-pulse">Ready for an Adventure?</h2>
                <p class="text-lg mb-8 max-w-2xl mx-auto">Download the game and start your pixel adventure today! Enjoy endless gameplay, unlock powerful upgrades, and challenge epic bosses.</p>
                <div class="flex flex-wrap justify-center gap-4">
                    <a href="#" class="bg-green hover:bg-neongreen text-white font-pixel py-3 px-8 rounded pixel-border transform hover:scale-105 transition duration-300 inline-block">
                        Download Now
                    </a>
                    <a href="#" class="bg-purple hover:bg-darkpurple text-white font-pixel py-3 px-8 rounded pixel-border transform hover:scale-105 transition duration-300 inline-block">
                        View Source Code
                    </a>
                </div>
                <img src="images/8.png" alt="Game Character" class="w-24 h-24 mx-auto mt-8 pixel-sprite animate-bounce">
            </div>
        </section>
    </div>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registration successful:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }

        // Simple smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Handle image fade-in loading effect
        document.addEventListener('DOMContentLoaded', function() {
            const lazyImages = document.querySelectorAll('.lazy-image');
            
            // Create inline SVG as default image
            const defaultImageSVG = `data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${lazyImages[0].width || 300} ${lazyImages[0].height || 200}" %3E%3Crect width="100%" height="100%" fill="%232C3539"/%3E%3Ctext x="50%" y="50%" font-family="Arial" font-size="20" fill="%23FFFFFF" text-anchor="middle" dominant-baseline="middle"%3EImage not available%3C/text%3E%3C/svg%3E`;
            
            // Preload images
            function preloadImage(url) {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.src = url;
                    img.onload = () => resolve(url);
                    img.onerror = () => reject(url);
                });
            }
            
            // Batch preload first screen images
            Promise.allSettled(Array.from(lazyImages).map(img => preloadImage(img.src)))
                .then(results => {
                    console.log('Preloading images complete', results);
                });
            
            // Set default image attributes and error handling
            lazyImages.forEach(img => {
                // Set default image placeholder
                img.setAttribute('onerror', `this.onerror=null;this.src='${defaultImageSVG}';this.classList.add('loaded')`);
                
                // Force image display mode
                img.style.objectFit = 'cover';
                
                // Add priority for first screen images
                if (img.getBoundingClientRect().top < window.innerHeight) {
                    img.setAttribute('fetchpriority', 'high');
                    img.setAttribute('loading', 'eager');
                }
            });
            
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            
                            // Ensure image is loaded before adding loaded class
                            if (img.complete) {
                                img.classList.add('loaded');
                            } else {
                                img.addEventListener('load', function() {
                                    img.classList.add('loaded');
                                });
                            }
                            
                            imageObserver.unobserve(img);
                        }
                    });
                }, { 
                    threshold: 0.1, 
                    rootMargin: "200px" // Increase visible range preloading
                });
                
                lazyImages.forEach(img => {
                    // For first screen images, load immediately
                    if(img.getBoundingClientRect().top < window.innerHeight) {
                        img.classList.add('loaded');
                    } else {
                        imageObserver.observe(img);
                    }
                });
            } else {
                // Fallback: Load all images directly for older browsers
                lazyImages.forEach(img => {
                    img.classList.add('loaded');
                });
            }
        });

        // Lazy load iframe on button click
        document.getElementById('load-game-btn').addEventListener('click', function() {
            const gameContainer = document.getElementById('game-container');
            const placeholder = document.getElementById('game-placeholder');
            
            // Remove placeholder
            placeholder.style.display = 'none';
            
            // Show loading indicator
            const loadingIndicator = document.createElement('div');
            loadingIndicator.className = 'text-center text-white animate__animated animate__pulse animate__infinite';
            loadingIndicator.innerHTML = '<p class="text-xl font-game mb-4">Loading game...</p><div class="mt-2 w-16 h-16 border-4 border-game-green border-t-transparent rounded-full animate-spin mx-auto"></div>';
            gameContainer.appendChild(loadingIndicator);
            
            // Use correct game source
            const iframe = document.createElement('iframe');
            iframe.src = 'https://cloud.onlinegames.io/games/2025/unity/monster-survivors/index-og.html';
            iframe.title = 'Play Monster Survivors';
            iframe.id = 'game-iframe';
            iframe.className = 'w-full h-full border-0';
            iframe.style.display = 'none';
            iframe.setAttribute('loading', 'eager'); // Use eager to prioritize loading
            iframe.setAttribute('importance', 'high'); // Mark as high priority resource
            iframe.setAttribute('allowfullscreen', 'true');
            iframe.setAttribute('allow', 'autoplay; fullscreen; web-share');
            iframe.setAttribute('sandbox', 'allow-scripts allow-same-origin allow-popups allow-forms allow-popups-to-escape-sandbox');
            
            // Set CORS policy
            iframe.setAttribute('crossorigin', 'anonymous');
            
            // Preconnect to game domain to reduce loading time
            const preconnectLink = document.createElement('link');
            preconnectLink.rel = 'preconnect';
            preconnectLink.href = 'https://cloud.onlinegames.io';
            document.head.appendChild(preconnectLink);
            
            gameContainer.appendChild(iframe);
            
            // Set load timeout
            const loadTimeout = setTimeout(() => {
                showBackupOptions();
            }, 15000); // Extend timeout to 15 seconds
            
            // When iframe is loaded, hide loading indicator and show game
            iframe.addEventListener('load', function() {
                clearTimeout(loadTimeout); // Clear timeout timer
                loadingIndicator.remove();
                iframe.style.display = 'block';
                
                // Add success message
                console.log('Game iframe loaded successfully');
                
                // Try to communicate with game content
                try {
                    iframe.contentWindow.postMessage({type: 'GAME_READY'}, '*');
                } catch (e) {
                    console.warn('Failed to communicate with game content', e);
                }
                
                // Show game loaded notification
                showGameLoadedToast();
            });
            
            // Handle iframe load failure
            iframe.addEventListener('error', function(e) {
                console.error('Failed to load game iframe', e);
                clearTimeout(loadTimeout);
                showBackupOptions();
            });
            
            function showBackupOptions() {
                loadingIndicator.remove();
                const backupMessage = document.createElement('div');
                backupMessage.className = 'text-center bg-game-darkbg p-6 rounded-md';
                backupMessage.innerHTML = `
                    <p class="text-xl text-game-yellow mb-4 font-pixel">Failed to load game</p>
                    <p class="text-white mb-4">Please try the following options:</p>
                    <div class="space-y-4">
                        <a href="https://cloud.onlinegames.io/games/2025/unity/monster-survivors/index-og.html" target="_blank" 
                           class="block bg-game-neongreen text-game-darkbg hover:bg-green-500 font-bold py-2 px-6 rounded-md transition-all duration-300">
                            Open Game in New Window
                        </a>
                        <button id="retry-btn" class="block w-full bg-game-purple text-white hover:bg-purple-700 font-bold py-2 px-6 rounded-md transition-all duration-300">
                            Retry Loading
                        </button>
                        <button id="alt-game-btn" class="block w-full bg-game-orange text-white hover:bg-yellow-600 font-bold py-2 px-6 rounded-md transition-all duration-300">
                            Try Alternative Source
                        </button>
                    </div>
                `;
                gameContainer.appendChild(backupMessage);
                
                // Add event listener for retry button
                document.getElementById('retry-btn').addEventListener('click', function() {
                    gameContainer.innerHTML = '';
                    gameContainer.appendChild(placeholder);
                    placeholder.style.display = 'block';
                    document.getElementById('load-game-btn').click();
                });
                
                // Add event listener for alternative game source button
                document.getElementById('alt-game-btn').addEventListener('click', function() {
                    gameContainer.innerHTML = '';
                    const altLoadingIndicator = document.createElement('div');
                    altLoadingIndicator.className = 'text-center text-white animate__animated animate__pulse animate__infinite';
                    altLoadingIndicator.innerHTML = '<p class="text-xl font-game mb-4">Loading alternative game...</p><div class="mt-2 w-16 h-16 border-4 border-game-orange border-t-transparent rounded-full animate-spin mx-auto"></div>';
                    gameContainer.appendChild(altLoadingIndicator);
                    
                    // Use alternative game source
                    const altIframe = document.createElement('iframe');
                    altIframe.src = 'https://wanted5games.com/games/html5/ninja-vs-zombies-new-en-s-iga-cloud/index.html?pub=10';
                    altIframe.title = 'Play Alternative Game';
                    altIframe.className = 'w-full h-full border-0';
                    altIframe.style.display = 'none';
                    altIframe.setAttribute('loading', 'eager');
                    altIframe.setAttribute('allowfullscreen', 'true');
                    altIframe.setAttribute('allow', 'autoplay; fullscreen');
                    gameContainer.appendChild(altIframe);
                    
                    altIframe.addEventListener('load', function() {
                        altLoadingIndicator.remove();
                        altIframe.style.display = 'block';
                    });
                    
                    altIframe.addEventListener('error', function() {
                        altLoadingIndicator.remove();
                        gameContainer.innerHTML = `
                            <div class="text-center p-6">
                                <p class="text-xl text-game-yellow mb-4 font-pixel">All game sources failed to load</p>
                                <p class="text-white mb-4">Please check your internet connection or try again later</p>
                                <button id="final-retry-btn" class="inline-block bg-game-purple text-white hover:bg-purple-700 font-bold py-2 px-6 rounded-md transition-all duration-300">
                                    Return to Homepage
                                </button>
                            </div>
                        `;
                        document.getElementById('final-retry-btn').addEventListener('click', function() {
                            window.location.reload();
                        });
                    });
                });
            }
            
            // Record game start time for statistics
            if (window.localStorage) {
                localStorage.setItem('gameStartTime', new Date().getTime());
            }
        });

        // Inline worker code to handle worker.js not existing issue
        if (window.Worker) {
            // Create Blob URL
            const workerCode = `
                // Web Worker for preloading resources
                self.addEventListener('message', function(e) {
                    const data = e.data;
                    if (data.cmd === 'preloadResources') {
                        const resources = data.resources || [];
                        let loaded = 0;
                        const results = [];
                        
                        // If no resources need preloading, return immediately
                        if (resources.length === 0) {
                            self.postMessage({
                                type: 'resourcesPreloaded',
                                count: 0,
                                results: []
                            });
                            return;
                        }
                        
                        // Preload each resource
                        resources.forEach(url => {
                            fetch(url, { 
                                mode: 'no-cors',
                                cache: 'force-cache'
                            })
                            .then(response => {
                                results.push({
                                    url: url,
                                    status: 'success'
                                });
                            })
                            .catch(error => {
                                results.push({
                                    url: url,
                                    status: 'error',
                                    error: error.message
                                });
                            })
                            .finally(() => {
                                loaded++;
                                
                                // When all resources have been attempted to load
                                if (loaded === resources.length) {
                                    self.postMessage({
                                        type: 'resourcesPreloaded',
                                        count: loaded,
                                        results: results
                                    });
                                }
                            });
                        });
                    }
                });
            `;
            
            // Create Blob and URL
            const blob = new Blob([workerCode], { type: 'application/javascript' });
            const workerURL = URL.createObjectURL(blob);
            
            // Use inline worker
            const worker = new Worker(workerURL);
            
            // Send preloading resource request to Worker
            worker.postMessage({
                cmd: 'preloadResources',
                resources: [
                    'images/1.jpg',
                    'images/2.jpg',
                    'images/3.jpg',
                    'images/4.jpg',
                    'images/6.jpg',
                    'images/7.jpg',
                    'images/8.png'
                ]
            });
            
            // Listen for Worker messages
            worker.addEventListener('message', function(e) {
                const data = e.data;
                if (data.type === 'resourcesPreloaded') {
                    console.log('Preloading resources complete: ' + data.count, data.results);
                    
                    // When resources have finished preloading, show "Play Now" button animation
                    const playBtn = document.querySelector('.pulse-button');
                    if (playBtn) {
                        playBtn.classList.add('animate__animated', 'animate__heartBeat');
                        setTimeout(() => {
                            playBtn.classList.remove('animate__heartBeat');
                        }, 1500);
                    }
                    
                    // Release blob URL
                    URL.revokeObjectURL(workerURL);
                    
                    // Hide skeleton screen, show real content
                    setTimeout(() => {
                        const skeleton = document.getElementById('page-skeleton');
                        if (skeleton) {
                            skeleton.style.opacity = '0';
                            setTimeout(() => {
                                skeleton.style.display = 'none';
                                document.querySelector('.container').style.opacity = '1';
                            }, 300);
                        }
                    }, 100);
                }
            }, false);
        }

        // Optimize animations with IntersectionObserver
        document.addEventListener('DOMContentLoaded', function() {
            // Only animate elements when they're in viewport
            const animatedElements = document.querySelectorAll('.animate__animated');
            
            if ('IntersectionObserver' in window) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        // Add animation classes only when element is visible
                        if (entry.isIntersecting) {
                            if (entry.target.classList.contains('animate__animated--paused')) {
                                entry.target.classList.remove('animate__animated--paused');
                            }
                            // Unobserve after animation starts
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });
                
                animatedElements.forEach(element => {
                    // Pause animations initially
                    if (!element.classList.contains('animate__pulse')) {
                        element.classList.add('animate__animated--paused');
                    }
                    observer.observe(element);
                });
            }
            
            // Remove unnecessary animations on mobile to improve performance
            if (window.innerWidth < 768) {
                document.querySelectorAll('.hover-scale').forEach(el => {
                    el.classList.remove('hover-scale');
                });
                
                // Reduce animation effects on mobile devices to optimize performance
                document.querySelectorAll('.game-card').forEach(card => {
                    card.classList.remove('game-card');
                });
            }
            
            // Hide skeleton screen, show real content
            setTimeout(() => {
                const skeleton = document.getElementById('page-skeleton');
                if (skeleton) {
                    skeleton.style.opacity = '0';
                    setTimeout(() => {
                        skeleton.style.display = 'none';
                        document.querySelector('.container').style.opacity = '1';
                    }, 300);
                }
            }, 800);
            
            // Check browser support and add resource hint
            if ('connection' in navigator) {
                // Optimize loading based on network type
                const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                if (connection && connection.effectiveType) {
                    if (connection.effectiveType === '4g') {
                        // Load more resources on fast connections
                        const preloadLinks = [
                            { href: 'https://cloud.onlinegames.io/games/2025/unity/monster-survivors/index-og.html', as: 'document' }
                        ];
                        
                        preloadLinks.forEach(link => {
                            const preload = document.createElement('link');
                            preload.rel = 'prefetch';
                            preload.href = link.href;
                            if (link.as) preload.as = link.as;
                            document.head.appendChild(preload);
                        });
                    } else if (connection.effectiveType === '3g' || connection.effectiveType === '2g') {
                        // Reduce image quality on slow connections
                        document.querySelectorAll('img').forEach(img => {
                            if (!img.src.includes('logo')) {
                                img.setAttribute('loading', 'lazy');
                                // Try using lower quality images
                                if (img.src.includes('.jpg') || img.src.includes('.jpeg')) {
                                    img.src = img.src.replace('.jpg', '-low.jpg').replace('.jpeg', '-low.jpeg');
                                }
                            }
                        });
                    }
                }
            }
            
            // Use content visibility API to optimize performance
            if ('contentVisibilityAPI' in document || 'content-visibility' in document.body.style) {
                const sections = document.querySelectorAll('section');
                sections.forEach(section => {
                    section.style.contentVisibility = 'auto';
                    section.style.containIntrinsicSize = '0 500px';
                });
            }
            
            // Use requestIdleCallback to load non-critical resources when browser is idle
            if ('requestIdleCallback' in window) {
                requestIdleCallback(() => {
                    // Preload possible next page content
                    const nextPageLinks = ['https://cloud.onlinegames.io/games/2025/unity/monster-survivors/index-og.html'];
                    nextPageLinks.forEach(link => {
                        const preload = document.createElement('link');
                        preload.rel = 'prefetch';
                        preload.href = link;
                        document.head.appendChild(preload);
                    });
                    
                    // Register page analytics
                    if ('performance' in window) {
                        const pagePerformance = {
                            loadTime: window.performance.timing.domContentLoadedEventEnd - window.performance.timing.navigationStart,
                            resources: window.performance.getEntriesByType('resource').length
                        };
                        console.log('Page performance:', pagePerformance);
                    }
                }, { timeout: 5000 });
            }
        });

        // 检测WebP格式支持
        function checkWebP(feature, callback) {
            var kTestImages = {
                lossy: "UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",
                lossless: "UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",
                alpha: "UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",
                animation: "UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"
            };
            var img = new Image();
            img.onload = function () {
                var result = (img.width > 0) && (img.height > 0);
                callback(feature, result);
            };
            img.onerror = function () {
                callback(feature, false);
            };
            img.src = "data:image/webp;base64," + kTestImages[feature];
        }

        // 检测WebP支持并标记在HTML上
        checkWebP('lossy', function(feature, supported) {
            if (supported) {
                document.documentElement.classList.add('webp');
                
                // 替换所有jpg/png图片为webp格式(如果有webp版本的话)
                document.addEventListener('DOMContentLoaded', function() {
                    const images = document.querySelectorAll('img[src$=".jpg"], img[src$=".png"]');
                    images.forEach(img => {
                        // 创建对应的webp路径
                        const webpSrc = img.src.replace(/\.(jpg|png)$/i, '.webp');
                        
                        // 预加载webp图片
                        const preloadImg = new Image();
                        preloadImg.onload = function() {
                            // 如果webp加载成功，替换原图
                            img.src = webpSrc;
                        };
                        preloadImg.src = webpSrc;
                    });
                });
            } else {
                document.documentElement.classList.add('no-webp');
            }
        });

        // 增强图片错误处理
        document.addEventListener('DOMContentLoaded', function() {
            const allImages = document.querySelectorAll('img');
            allImages.forEach(img => {
                // 确保所有图片都有alt属性
                if (!img.alt || img.alt === '') {
                    img.alt = "Monster Survivors pixel game - " + (img.src.split('/').pop().split('.')[0] || "gameplay");
                }
                
                // 添加加载完成事件
                img.addEventListener('load', function() {
                    this.classList.add('loaded');
                    
                    // 记录图片加载性能
                    if (window.performance && window.performance.getEntriesByName) {
                        const imgPerf = window.performance.getEntriesByName(this.src)[0];
                        if (imgPerf) {
                            console.log(`Image ${this.src.split('/').pop()} loaded in ${imgPerf.duration.toFixed(2)}ms`);
                        }
                    }
                });
                
                // 增强图片错误处理
                img.addEventListener('error', function() {
                    // 创建备用的占位图
                    const fallbackSrc = `data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${img.width || 300} ${img.height || 200}" %3E%3Crect width="100%" height="100%" fill="%232C3539"/%3E%3Ctext x="50%" y="50%" font-family="Arial" font-size="20" fill="%23FFFFFF" text-anchor="middle" dominant-baseline="middle"%3EImage not available%3C/text%3E%3C/svg%3E`;
                    
                    // 尝试加载原始格式
                    if (img.src.endsWith('.webp')) {
                        // 如果webp加载失败，尝试回退到jpg/png
                        const originalSrc = img.src.replace('.webp', img.src.match(/\.webp$/i) ? '.jpg' : '.png');
                        img.src = originalSrc;
                        
                        // 再次添加错误处理以防原始格式也加载失败
                        img.onerror = function() {
                            img.src = fallbackSrc;
                            img.classList.add('loaded'); // 确保占位图显示
                            console.warn('Image failed to load:', originalSrc);
                        };
                    } else {
                        img.src = fallbackSrc;
                        img.classList.add('loaded'); // 确保占位图显示
                        console.warn('Image failed to load:', img.src);
                    }
                });
                
                // 添加尺寸属性
                if (!img.width && !img.height) {
                    // 根据不同图片设置默认尺寸以减少CLS
                    if (img.src.includes('screenshot') || img.src.includes('gameplay')) {
                        img.width = 800;
                        img.height = 450;
                    } else if (img.src.includes('avatar') || img.src.includes('player')) {
                        img.width = 100;
                        img.height = 100;
                    }
                }
                
                // 更好的懒加载设置
                if (img.getBoundingClientRect().top > window.innerHeight * 1.5) {
                    img.loading = 'lazy';
                    img.decoding = 'async';
                } else {
                    img.loading = 'eager';
                }
                
                // 为图片添加结构化数据
                if (!img.hasAttribute('itemprop') && img.alt && !img.src.includes('placeholder')) {
                    img.setAttribute('itemprop', 'image');
                }
            });
            
            // 初始化懒加载IntersectionObserver
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            
                            // 延迟加载处理
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                delete img.dataset.src;
                            }
                            
                            // 加载高清图
                            if (img.dataset.srcset) {
                                img.srcset = img.dataset.srcset;
                                delete img.dataset.srcset;
                            }
                            
                            // 动态加载图片尺寸
                            if (img.dataset.sizes) {
                                img.sizes = img.dataset.sizes;
                                delete img.dataset.sizes;
                            }
                            
                            imageObserver.unobserve(img);
                        }
                    });
                }, { 
                    threshold: 0.1, 
                    rootMargin: "200px" 
                });
                
                // 观察所有需要懒加载的图片
                document.querySelectorAll('img[loading="lazy"]').forEach(img => {
                    imageObserver.observe(img);
                });
            }
        });
        
        // 添加响应式图片处理
        document.addEventListener('DOMContentLoaded', function() {
            // 为游戏截图添加响应式图片处理
            const gameScreenshots = document.querySelectorAll('.game-card img');
            gameScreenshots.forEach(img => {
                // 只针对游戏截图进行处理
                if (img.src.includes('images/') && !img.src.includes('logo') && !img.srcset) {
                    // 获取图片基本路径
                    const baseSrc = img.src.substring(0, img.src.lastIndexOf('.'));
                    const ext = img.src.substring(img.src.lastIndexOf('.'));
                    
                    // 为不同设备添加不同尺寸图片
                    // 注意：这里假设服务器上有对应的尺寸图片，实际使用时需要确保这些图片存在
                    img.srcset = `
                        ${baseSrc}-small${ext} 400w,
                        ${baseSrc}${ext} 800w,
                        ${baseSrc}-large${ext} 1200w
                    `;
                    
                    img.sizes = '(max-width: 640px) 400px, (max-width: 1024px) 800px, 1200px';
                    
                    // 添加对webp格式的支持
                    if (document.documentElement.classList.contains('webp')) {
                        img.srcset = `
                            ${baseSrc}-small.webp 400w,
                            ${baseSrc}.webp 800w,
                            ${baseSrc}-large.webp 1200w
                        `;
                    }
                }
            });
        });
        
        // 根据设备性能动态调整图片质量
        function adjustImageQualityForDevice() {
            // 检测设备性能
            const isLowEnd = navigator.hardwareConcurrency <= 2 || 
                          (navigator.deviceMemory && navigator.deviceMemory <= 2);
                          
            // 在低端设备上降低图片质量
            if (isLowEnd) {
                document.documentElement.classList.add('low-end-device');
                const images = document.querySelectorAll('img:not([loading="eager"])');
                images.forEach(img => {
                    // 添加模糊滤镜来减少渲染压力
                    img.style.filter = 'blur(0.5px)';
                    
                    // 降低非首屏图片的优先级
                    if (img.getBoundingClientRect().top > window.innerHeight) {
                        img.loading = 'lazy';
                        img.decoding = 'async';
                    }
                });
            }
        }
        
        // 调用设备性能检测
        adjustImageQualityForDevice();

        // 添加实时玩家计数更新效果
        function updatePlayerCount() {
            const playerCountElement = document.getElementById('player-count');
            const currentCount = parseInt(playerCountElement.textContent.replace(/,/g, ''));
            
            // 随机增减少量玩家数，模拟实时效果
            const randomChange = Math.floor(Math.random() * 7) - 3; // -3 到 3 之间的随机数
            let newCount = currentCount + randomChange;
            
            // 确保玩家数不会低于基准值的80%
            const baseCount = 2476;
            if (newCount < baseCount * 0.8) {
                newCount = Math.floor(baseCount * 0.8);
            }
            
            // 格式化数字为带逗号的形式
            playerCountElement.textContent = newCount.toLocaleString();
        }
        
        // 每30秒更新一次玩家计数
        setInterval(updatePlayerCount, 30000);
        
        // 添加全屏功能
        document.getElementById('fullscreen-btn').addEventListener('click', function() {
            const gameIframe = document.getElementById('game-iframe');
            if (!gameIframe) {
                alert('请先启动游戏！');
                return;
            }
            
            const gameContainer = document.getElementById('game-container');
            
            if (document.fullscreenElement) {
                document.exitFullscreen().catch(err => {
                    console.error('退出全屏出错:', err);
                });
            } else {
                gameContainer.requestFullscreen().catch(err => {
                    // 如果浏览器不支持requestFullscreen，尝试使用游戏iframe的全屏
                    try {
                        gameIframe.contentWindow.postMessage({type: 'REQUEST_FULLSCREEN'}, '*');
                    } catch (e) {
                        console.error('无法进入全屏模式:', err);
                        alert('您的浏览器不支持全屏模式，请尝试使用其他浏览器。');
                    }
                });
            }
        });
        
        // 添加游戏加载成功通知
        function showGameLoadedToast() {
            const toast = document.createElement('div');
            toast.className = 'game-toast';
            toast.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background-color: #34C759;
                color: white;
                padding: 10px 20px;
                border-radius: 5px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
                z-index: 1000;
                font-weight: bold;
                display: flex;
                align-items: center;
                transform: translateY(100px);
                opacity: 0;
                transition: transform 0.5s ease, opacity 0.5s ease;
            `;
            
            toast.innerHTML = `
                <div style="background-color: rgba(255,255,255,0.2); border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; margin-right: 10px;">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 0C3.58 0 0 3.58 0 8C0 12.42 3.58 16 8 16C12.42 16 16 12.42 16 8C16 3.58 12.42 0 8 0ZM6.5 12L2 7.5L3.4 6.1L6.5 9.2L12.6 3.1L14 4.5L6.5 12Z" fill="white"/>
                    </svg>
                </div>
                <span>Game loaded successfully! Press ESC to exit fullscreen.</span>
            `;
            
            document.body.appendChild(toast);
            
            // 显示动画
            setTimeout(() => {
                toast.style.transform = 'translateY(0)';
                toast.style.opacity = '1';
            }, 100);
            
            // 几秒后隐藏
            setTimeout(() => {
                toast.style.transform = 'translateY(100px)';
                toast.style.opacity = '0';
                
                // 彻底移除元素
                setTimeout(() => {
                    toast.remove();
                }, 500);
            }, 5000);
        }
    </script>
    
    <!-- 添加结构化数据以提高SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "VideoGame",
      "name": "Monster Survivors",
      "description": "Monster Survivors is a free-to-play retro pixel survival roguelike with endless gameplay. Battle waves of monsters, collect gems for upgrades, and face challenging boss fights in this addictive pixel art adventure.",
      "operatingSystem": "Windows, macOS, Linux, Browser",
      "applicationCategory": "Game",
      "gamePlatform": "PC, Web Browser",
      "genre": ["Roguelike", "Survival", "Retro", "Pixel Art", "Action"],
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "ratingCount": "2476",
        "bestRating": "5",
        "worstRating": "1"
      },
      "image": "images/1.jpg",
      "screenshot": [
        "images/1.jpg",
        "images/3.jpg",
        "images/4.jpg",
        "images/6.jpg", 
        "images/7.jpg",
        "images/8.png"
      ],
      "author": {
        "@type": "Organization",
        "name": "Pixel Adventure Studios",
        "url": "https://pixeladventurestudios.com"
      },
      "datePublished": "2023-10-05",
      "contentRating": "Everyone"
    }
    </script>
    
    <!-- 页面性能监控脚本 -->
    <script>
    // 监测核心网页指标
    if ('PerformanceObserver' in window) {
        // 首次内容绘制 (FCP)
        const fcpObserver = new PerformanceObserver((entryList) => {
            const entries = entryList.getEntries();
            const firstEntry = entries[0];
            console.log(`FCP: ${firstEntry.startTime}ms`);
            
            // 如果FCP太慢，减少一些视觉效果
            if (firstEntry.startTime > 2000) {
                document.querySelectorAll('.animate__animated').forEach(el => {
                    el.classList.remove('animate__animated');
                });
                console.log('已移除动画以提高性能');
            }
            
            // FCP 完成后，显示页面内容
            const skeleton = document.getElementById('page-skeleton');
            if (skeleton && skeleton.style.display !== 'none') {
                skeleton.style.opacity = '0';
                setTimeout(() => {
                    skeleton.style.display = 'none';
                    document.querySelector('.container').style.opacity = '1';
                }, 300);
            }
        });
        fcpObserver.observe({type: 'paint', buffered: true});
        
        // 最大内容绘制 (LCP)
        const lcpObserver = new PerformanceObserver((entryList) => {
            const entries = entryList.getEntries();
            const lastEntry = entries[entries.length - 1];
            console.log(`LCP: ${lastEntry.startTime}ms`);
        });
        lcpObserver.observe({type: 'largest-contentful-paint', buffered: true});
        
        // 首次输入延迟 (FID)
        const fidObserver = new PerformanceObserver((entryList) => {
            const entries = entryList.getEntries();
            entries.forEach(entry => {
                console.log(`FID: ${entry.processingStart - entry.startTime}ms`);
            });
        });
        fidObserver.observe({type: 'first-input', buffered: true});
        
        // 累计布局偏移 (CLS)
        const clsObserver = new PerformanceObserver((entryList) => {
            let clsValue = 0;
            const entries = entryList.getEntries();
            
            entries.forEach(entry => {
                if (!entry.hadRecentInput) {
                    clsValue += entry.value;
                }
            });
            
            console.log(`CLS: ${clsValue}`);
        });
        clsObserver.observe({type: 'layout-shift', buffered: true});
    }
    
    // 页面完全加载后运行优化
    window.addEventListener('load', function() {
        // 显示主内容，隐藏骨架屏
        const skeleton = document.getElementById('page-skeleton');
        if (skeleton && skeleton.style.display !== 'none') {
            skeleton.style.opacity = '0';
            setTimeout(() => {
                skeleton.style.display = 'none';
                document.querySelector('.container').style.opacity = '1';
            }, 300);
        }
        
        // Remove unnecessary preload links
        setTimeout(() => {
            document.querySelectorAll('link[rel="preload"], link[rel="prefetch"]').forEach(link => {
                if (link.hasAttribute('as') && link.getAttribute('as') === 'document') {
                    link.remove();
                }
            });
        }, 3000);
        
        // Record total page load time
        if (window.performance) {
            const pageLoadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
            console.log(`Total page load time: ${pageLoadTime}ms`);
            
            // Report performance metrics (this is just an example, in practice might be sent to an analytics server)
            const performanceData = {
                pageLoadTime,
                domContentLoaded: window.performance.timing.domContentLoadedEventEnd - window.performance.timing.navigationStart,
                resourceCount: window.performance.getEntriesByType('resource').length,
                userAgent: navigator.userAgent,
                screenSize: `${window.innerWidth}x${window.innerHeight}`,
                timestamp: new Date().toISOString()
            };
            
            console.log('Page performance data:', performanceData);
        }
    });
    </script>

    <!-- 添加Google评分结构化数据以优化SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org/",
        "@type": "VideoGame",
        "name": "Monster Survivors",
        "alternateName": "Monster Survivors",
        "description": "A free-to-play retro pixel survival roguelike game with endless gameplay. Defeat hordes of monsters, collect gems, upgrade your character, and survive as long as possible in this addictive browser game.",
        "operatingSystem": "Web Browser",
        "applicationCategory": "Game",
        "gamePlatform": "Web Browser",
        "genre": ["Roguelike", "Survival", "Retro", "Pixel Art", "Action"],
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "ratingCount": "2476",
            "bestRating": "5",
            "worstRating": "1"
        },
        "image": [
            "images/1.webp",
            "images/2.webp",
            "images/3.webp",
            "images/4.webp",
            "images/6.webp",
            "images/7.webp",
            "images/8.webp"
        ],
        "screenshot": [
            "images/1.webp",
            "images/3.webp",
            "images/4.webp"
        ],
        "author": {
            "@type": "Organization",
            "name": "Pixel Adventure Studios",
            "url": "https://www.pixeladventurestudios.com"
        },
        "datePublished": "2023-10-05",
        "contentRating": "Everyone"
    }
    </script>

    <!-- Improve image loading with preloading script -->
    <script>
        // Preload critical images
        window.addEventListener('load', function() {
            // Add preloading for critical images
            const imagesToPreload = [
                'images/1.jpg',
                'images/2.jpg',
                'images/3.jpg',
                'images/4.jpg',
                'images/6.jpg',
                'images/7.jpg',
                'images/8.png'
            ];
            
            imagesToPreload.forEach(src => {
                const img = new Image();
                img.src = src;
            });
            
            // Fix image display issues
            document.querySelectorAll('.lazy-image').forEach(img => {
                // If image is already loaded but not visible, make sure it's visible
                if (img.complete && img.naturalHeight !== 0) {
                    img.style.opacity = '1';
                    const placeholder = img.closest('.img-placeholder');
                    if (placeholder && placeholder.classList.contains('advanced-skeleton')) {
                        placeholder.classList.remove('advanced-skeleton');
                    }
                }
                
                // Add load event handler for images that are still loading
                img.addEventListener('load', function() {
                    img.style.opacity = '1';
                    const placeholder = img.closest('.img-placeholder');
                    if (placeholder && placeholder.classList.contains('advanced-skeleton')) {
                        placeholder.classList.remove('advanced-skeleton');
                    }
                });
                
                // Make sure error handler is added for all images
                img.addEventListener('error', function() {
                    // If image has onerror attribute, it will handle the fallback
                    // Otherwise, we apply a generic fallback here
                    if (!img.hasAttribute('onerror')) {
                        img.src = 'data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 400 225\'%3E%3Crect width=\'100%25\' height=\'100%25\' fill=\'%232C3539\'/%3E%3Ctext x=\'50%25\' y=\'50%25\' font-family=\'Arial\' font-size=\'20\' fill=\'%23FFFFFF\' text-anchor=\'middle\' dominant-baseline=\'middle\'%3EImage Not Found%3C/text%3E%3C/svg%3E';
                    }
                });
            });
        });
    </script>

    <!-- Footer -->
    <footer class="bg-game-darkbg text-white pt-16 pb-8 relative">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
                <div>
                    <h3 class="text-xl font-bold mb-4 text-game-neongreen pixel-text">About Us</h3>
                    <p class="mb-4">We are a small team of independent developers passionate about creating fun and challenging pixel-style games.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-game-neongreen hover:text-green-400 transition-colors">
                            <i class="fab fa-twitter text-xl"></i>
                        </a>
                        <a href="#" class="text-game-neongreen hover:text-green-400 transition-colors">
                            <i class="fab fa-discord text-xl"></i>
                        </a>
                        <a href="#" class="text-game-neongreen hover:text-green-400 transition-colors">
                            <i class="fab fa-github text-xl"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4 text-game-neongreen pixel-text">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">Home</a></li>
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">Game Features</a></li>
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">Download</a></li>
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">Community</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4 text-game-neongreen pixel-text">Support</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">FAQ</a></li>
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">Game Guide</a></li>
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">Contact Us</a></li>
                        <li><a href="#" class="hover:text-game-neongreen transition-colors">Bug Reports</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4 text-game-neongreen pixel-text">Subscribe</h3>
                    <p class="mb-4">Get the latest news about game updates, new features, and upcoming events.</p>
                    <form class="flex">
                        <input type="email" placeholder="Your Email" class="py-2 px-4 rounded-l-lg bg-game-darkgreen text-white focus:outline-none">
                        <button type="submit" class="bg-game-neongreen text-game-darkbg font-bold py-2 px-4 rounded-r-lg hover:bg-green-400 transition-colors">Subscribe</button>
                    </form>
                </div>
            </div>
            <div class="border-t border-gray-700 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p>&copy; 2023 Pixel Adventure Games. All Rights Reserved.</p>
                    <div class="flex space-x-6 mt-4 md:mt-0">
                        <a href="#" class="hover:text-game-neongreen transition-colors">Privacy Policy</a>
                        <a href="#" class="hover:text-game-neongreen transition-colors">Terms of Service</a>
                        <a href="#" class="hover:text-game-neongreen transition-colors">Cookie Policy</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="absolute bottom-0 left-0 w-full h-2 bg-game-neongreen pixel-border-top"></div>
    </footer>

    <!-- 优化后的图片加载修复脚本 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 图片加载优化函数
            const optimizeImages = () => {
                const imageElements = document.querySelectorAll('img');
                
                imageElements.forEach((img) => {
                    // 获取原始路径
                    const originalSrc = img.getAttribute('src');
                    
                    // 添加alt属性（如果没有）
                    if (!img.hasAttribute('alt') || img.getAttribute('alt') === '') {
                        const altText = img.getAttribute('data-alt') || 
                                     originalSrc.split('/').pop().split('.')[0].replace(/[-_]/g, ' ');
                        img.setAttribute('alt', altText);
                    }
                    
                    // 添加懒加载属性（如果没有）
                    if (!img.hasAttribute('loading')) {
                        img.setAttribute('loading', 'lazy');
                    }
                    
                    // 确保图片可见
                    img.style.opacity = '1';
                    img.style.visibility = 'visible';
                    img.style.display = '';
                    
                    // 处理父容器
                    const parent = img.parentElement;
                    if (parent && (parent.classList.contains('img-placeholder') || 
                                 parent.classList.contains('advanced-skeleton'))) {
                        parent.style.opacity = '1';
                        parent.style.visibility = 'visible';
                        parent.classList.remove('advanced-skeleton');
                    }
                    
                    // 处理未完成加载的图片
                    if (!img.complete || img.naturalHeight === 0) {
                        // 添加错误处理
                        img.onerror = function() {
                            // 如果有备用图片，则使用备用图片
                            const fallbackSrc = img.getAttribute('data-fallback');
                            if (fallbackSrc) {
                                img.src = fallbackSrc;
                            }
                        };
                        
                        // 尝试重新加载
                        const currentSrc = img.src;
                        img.src = '';
                        setTimeout(() => {
                            img.src = currentSrc;
                        }, 50);
                    }
                });
                
                // 移除所有骨架屏
                document.querySelectorAll('.advanced-skeleton, .img-placeholder').forEach(skeleton => {
                    skeleton.style.display = 'none';
                });
            };
            
            // 执行优化
            optimizeImages();
            
            // 在加载完成后再执行一次
            window.addEventListener('load', optimizeImages);
            
            // 在1秒后再次执行，确保处理动态加载的内容
            setTimeout(optimizeImages, 1000);
        });
    </script>
    
    <!-- 返回顶部按钮 -->
    <button id="back-to-top" title="返回顶部" aria-label="返回页面顶部">
        <!-- 像素风格箭头图标 -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#192B21" stroke="#192B21" stroke-width="0">
            <path d="M12,3 L4,12 L8,12 L8,20 L16,20 L16,12 L20,12 Z" />
        </svg>
        <span class="pixel-glow"></span>
    </button>
    
    <!-- 返回顶部按钮脚本 -->
    <script>
        // 在DOM加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 获取返回顶部按钮元素
            const backToTopButton = document.getElementById('back-to-top');
            
            // 使用IntersectionObserver优化滚动事件处理
            const scrollObserver = new IntersectionObserver(
                (entries) => {
                    // 当页面滚动超过可视区域时显示按钮
                    if (!entries[0].isIntersecting) {
                        backToTopButton.classList.add('show');
                    } else {
                        backToTopButton.classList.remove('show');
                    }
                },
                { threshold: 0, rootMargin: '-300px 0px 0px 0px' }
            );
            
            // 观察页面顶部元素
            const header = document.querySelector('header') || document.body.firstElementChild;
            scrollObserver.observe(header);
            
            // 添加点击事件监听器
            backToTopButton.addEventListener('click', function(e) {
                e.preventDefault();
                
                // 平滑滚动到页面顶部
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        });
    </script>
    
    <!-- 添加暗黑模式支持 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 创建暗黑模式切换按钮
            const createDarkModeToggle = () => {
                const toggleButton = document.createElement('button');
                toggleButton.id = 'dark-mode-toggle';
                toggleButton.title = '切换暗黑/明亮模式';
                toggleButton.setAttribute('aria-label', '切换暗黑模式');
                toggleButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path class="sun" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        <path class="moon" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                    <span class="pixel-glow"></span>
                `;
                
                // 应用像素风格
                toggleButton.style.cssText = `
                    position: fixed;
                    top: 30px;
                    right: 30px;
                    z-index: 99;
                    background-color: #34C759;
                    color: #192B21;
                    width: 56px;
                    height: 56px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    image-rendering: pixelated;
                    border: 4px solid #1A7F37;
                    box-shadow: 
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.3),
                        0 6px 0 #1A7F37,
                        0 8px 10px rgba(0, 0, 0, 0.5);
                    transform: rotate(-2deg);
                    clip-path: polygon(
                        0% 20%, 20% 0%, 80% 0%, 100% 20%,
                        100% 80%, 80% 100%, 20% 100%, 0% 80%
                    );
                    transition: all 0.3s ease;
                `;
                
                // 添加悬停效果
                toggleButton.addEventListener('mouseenter', () => {
                    toggleButton.style.backgroundColor = '#4AFF8F';
                    toggleButton.style.transform = 'translateY(-3px) rotate(2deg)';
                    toggleButton.style.boxShadow = `
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.5),
                        0 8px 0 #1A7F37,
                        0 10px 12px rgba(0, 0, 0, 0.6)
                    `;
                });
                
                toggleButton.addEventListener('mouseleave', () => {
                    toggleButton.style.backgroundColor = '#34C759';
                    toggleButton.style.transform = 'rotate(-2deg)';
                    toggleButton.style.boxShadow = `
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.3),
                        0 6px 0 #1A7F37,
                        0 8px 10px rgba(0, 0, 0, 0.5)
                    `;
                });
                
                // 添加点击效果
                toggleButton.addEventListener('mousedown', () => {
                    toggleButton.style.transform = 'translateY(2px) rotate(-1deg)';
                    toggleButton.style.boxShadow = `
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.3),
                        0 2px 0 #1A7F37,
                        0 4px 6px rgba(0, 0, 0, 0.4)
                    `;
                });
                
                toggleButton.addEventListener('mouseup', () => {
                    toggleButton.style.transform = 'translateY(-3px) rotate(2deg)';
                    toggleButton.style.boxShadow = `
                        0 0 0 2px #000,
                        inset 0 0 0 2px rgba(255, 255, 255, 0.5),
                        0 8px 0 #1A7F37,
                        0 10px 12px rgba(0, 0, 0, 0.6)
                    `;
                });
                
                // 添加到页面
                document.body.appendChild(toggleButton);
                return toggleButton;
            };
            
            const toggleButton = createDarkModeToggle();
            
            // 检查用户偏好
            const prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
            let isDarkMode = localStorage.getItem('darkMode') === 'true' || 
                           (localStorage.getItem('darkMode') === null && prefersDarkMode);
            
            // 应用初始模式
            if (isDarkMode) {
                document.documentElement.classList.add('dark-mode');
                toggleButton.classList.add('active');
            }
            
            // 切换暗黑模式
            toggleButton.addEventListener('click', () => {
                isDarkMode = !isDarkMode;
                document.documentElement.classList.toggle('dark-mode', isDarkMode);
                toggleButton.classList.toggle('active', isDarkMode);
                localStorage.setItem('darkMode', isDarkMode);
            });
            
            // 添加暗黑模式CSS
            const darkModeStyle = document.createElement('style');
            darkModeStyle.textContent = `
                .dark-mode {
                    color-scheme: dark;
                }
                
                .dark-mode body {
                    background-color: #101C16;
                    background-image: 
                        linear-gradient(rgba(20, 50, 30, 0.15) 1px, transparent 1px),
                        linear-gradient(90deg, rgba(20, 50, 30, 0.15) 1px, transparent 1px);
                    color: #e0e0e0;
                }
                
                .dark-mode #dark-mode-toggle {
                    background-color: #1A7F37;
                    border-color: #115522;
                }
                
                .dark-mode #dark-mode-toggle:hover {
                    background-color: #34C759;
                }
                
                .dark-mode .sun {
                    display: none;
                }
                
                .dark-mode .moon {
                    display: inline;
                }
                
                .sun {
                    display: inline;
                }
                
                .moon {
                    display: none;
                }
                
                .dark-mode a {
                    color: #4AFF8F;
                }
                
                .dark-mode footer {
                    background-color: #0c1510;
                }
                
                .dark-mode header {
                    background-color: rgba(12, 21, 16, 0.8);
                }
                
                .dark-mode .bg-white {
                    background-color: #1c2c22;
                }
                
                .dark-mode .border {
                    border-color: #2c3c32;
                }
                
                .dark-mode .text-gray-700, 
                .dark-mode .text-gray-800, 
                .dark-mode .text-gray-900 {
                    color: #c0c0c0;
                }
                
                .dark-mode .text-black {
                    color: #e0e0e0;
                }
            `;
            document.head.appendChild(darkModeStyle);
        });
    </script>
    
    <!-- 性能优化：添加资源提示 -->
    <script>
        // 使用IntersectionObserver预加载可见区域附近的图片
        document.addEventListener('DOMContentLoaded', function() {
            const lazyImageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const src = img.getAttribute('data-src');
                        if (src) {
                            img.src = src;
                            img.removeAttribute('data-src');
                        }
                        observer.unobserve(img);
                    }
                });
            }, {
                rootMargin: '200px 0px' // 提前200px加载
            });
            
            // 查找所有具有data-src属性的图片
            document.querySelectorAll('img[data-src]').forEach(img => {
                lazyImageObserver.observe(img);
            });
            
            // 添加页面加载进度指示器
            if (!document.getElementById('page-load-progress')) {
                const progressBar = document.createElement('div');
                progressBar.id = 'page-load-progress';
                progressBar.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 0%;
                    height: 4px;
                    background-color: #34C759;
                    z-index: 9999;
                    transition: width 0.3s ease;
                `;
                document.body.appendChild(progressBar);
                
                // 更新进度条
                let loadProgress = 0;
                const updateProgress = () => {
                    loadProgress += (100 - loadProgress) / 10;
                    progressBar.style.width = loadProgress + '%';
                    if (loadProgress < 99) {
                        requestAnimationFrame(updateProgress);
                    }
                };
                updateProgress();
                
                // 页面加载完成时
                window.addEventListener('load', () => {
                    progressBar.style.width = '100%';
                    setTimeout(() => {
                        progressBar.style.opacity = '0';
                        setTimeout(() => {
                            progressBar.remove();
                        }, 300);
                    }, 500);
                });
            }
        });
    </script>

    <!-- 游戏留存系统 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 游戏成就和留存系统
            const achievementSystem = (() => {
                // 初始化成就数据
                const achievements = [
                    { id: 'firstRun', name: 'First Adventure', description: 'Complete your first game', icon: '🏆', unlocked: false },
                    { id: 'survive5min', name: 'Survivor', description: 'Survive for 5 minutes in a single game', icon: '⏱️', unlocked: false },
                    { id: 'survive10min', name: 'Survival Expert', description: 'Survive for 10 minutes in a single game', icon: '⌛', unlocked: false },
                    { id: 'survive30min', name: 'Immortal Legend', description: 'Survive for 30 minutes in a single game', icon: '🔥', unlocked: false },
                    { id: 'killFirst100', name: 'Monster Hunter', description: 'Kill a total of 100 monsters', icon: '🏹', unlocked: false },
                    { id: 'killFirst1000', name: 'Exterminator', description: 'Kill a total of 1000 monsters', icon: '⚔️', unlocked: false },
                    { id: 'collectFirst10', name: 'Collector', description: 'Collect 10 different abilities', icon: '🧩', unlocked: false },
                    { id: 'collectAll', name: 'Master of All', description: 'Collect all abilities', icon: '🌟', unlocked: false },
                    { id: 'defeatBoss', name: 'Boss Slayer', description: 'Defeat your first boss', icon: '👑', unlocked: false },
                    { id: 'defeatAllBosses', name: 'God of War', description: 'Defeat all bosses', icon: '🏅', unlocked: false },
                    { id: 'play3days', name: 'Game Enthusiast', description: 'Play for 3 consecutive days', icon: '📅', unlocked: false },
                    { id: 'play7days', name: 'Loyal Fan', description: 'Play for 7 consecutive days', icon: '🌈', unlocked: false }
                ];
                
                // 游戏数据和进度
                let gameData = {
                    playerName: '',
                    totalKills: 0,
                    totalPlayTime: 0,
                    highestSurvivalTime: 0,
                    collectedAbilities: [],
                    defeatedBosses: [],
                    lastPlayed: null,
                    consecutiveDays: 0,
                    achievements: achievements.reduce((acc, achievement) => {
                        acc[achievement.id] = achievement.unlocked;
                        return acc;
                    }, {})
                };
                
                // 加载游戏数据
                const loadGameData = () => {
                    try {
                        const savedData = localStorage.getItem('monsterSurvivorsData');
                        if (savedData) {
                            const parsedData = JSON.parse(savedData);
                            gameData = {...gameData, ...parsedData};
                            
                            // 检查每日登录
                            const now = new Date();
                            const lastPlayed = gameData.lastPlayed ? new Date(gameData.lastPlayed) : null;
                            
                            if (lastPlayed) {
                                const dayDiff = Math.floor((now - lastPlayed) / (1000 * 60 * 60 * 24));
                                
                                if (dayDiff === 1) {
                                    // 连续登录天数+1
                                    gameData.consecutiveDays++;
                                    
                                    // 检查连续登录成就
                                    if (gameData.consecutiveDays >= 3) {
                                        unlockAchievement('play3days');
                                    }
                                    if (gameData.consecutiveDays >= 7) {
                                        unlockAchievement('play7days');
                                    }
                                } else if (dayDiff > 1) {
                                    // 断签，重置连续天数
                                    gameData.consecutiveDays = 1;
                                }
                            } else {
                                gameData.consecutiveDays = 1;
                            }
                            
                            // 更新最后游玩时间
                            gameData.lastPlayed = now.toISOString();
                            saveGameData();
                        }
                    } catch (error) {
                        console.warn('加载游戏数据失败:', error);
                    }
                };
                
                // 保存游戏数据
                const saveGameData = () => {
                    try {
                        localStorage.setItem('monsterSurvivorsData', JSON.stringify(gameData));
                    } catch (error) {
                        console.warn('保存游戏数据失败:', error);
                    }
                };
                
                // 解锁成就
                const unlockAchievement = (achievementId) => {
                    if (!gameData.achievements[achievementId]) {
                        gameData.achievements[achievementId] = true;
                        saveGameData();
                        
                        // 找到成就详情
                        const achievement = achievements.find(a => a.id === achievementId);
                        if (achievement) {
                            showAchievementNotification(achievement);
                        }
                        
                        return true;
                    }
                    return false;
                };
                
                // 显示成就通知
                const showAchievementNotification = (achievement) => {
                    const notification = document.createElement('div');
                    notification.className = 'achievement-notification';
                    notification.style.cssText = `
                        position: fixed;
                        bottom: 20px;
                        left: 20px;
                        background-color: #192B21;
                        border: 3px solid #34C759;
                        color: white;
                        padding: 15px;
                        border-radius: 10px;
                        display: flex;
                        align-items: center;
                        z-index: 9999;
                        transform: translateY(100%);
                        opacity: 0;
                        transition: transform 0.5s ease, opacity 0.5s ease;
                        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                        max-width: 300px;
                    `;
                    
                    notification.innerHTML = `
                        <div style="font-size: 32px; margin-right: 12px;">${achievement.icon}</div>
                        <div>
                            <div style="font-weight: bold; color: #34C759; margin-bottom: 5px;">成就解锁！</div>
                            <div style="font-weight: bold;">${achievement.name}</div>
                            <div style="font-size: 12px; opacity: 0.8;">${achievement.description}</div>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    // 动画显示
                    setTimeout(() => {
                        notification.style.transform = 'translateY(0)';
                        notification.style.opacity = '1';
                    }, 100);
                    
                    // 几秒后隐藏
                    setTimeout(() => {
                        notification.style.transform = 'translateY(100%)';
                        notification.style.opacity = '0';
                        setTimeout(() => {
                            notification.remove();
                        }, 500);
                    }, 5000);
                };
                
                // 更新游戏数据
                const updateGameStats = (stats) => {
                    if (stats.survivalTime) {
                        if (stats.survivalTime > gameData.highestSurvivalTime) {
                            gameData.highestSurvivalTime = stats.survivalTime;
                        }
                        
                        // 检查存活时间成就
                        if (stats.survivalTime >= 5 * 60) { // 5分钟
                            unlockAchievement('survive5min');
                        }
                        if (stats.survivalTime >= 10 * 60) { // 10分钟
                            unlockAchievement('survive10min');
                        }
                        if (stats.survivalTime >= 30 * 60) { // 30分钟
                            unlockAchievement('survive30min');
                        }
                    }
                    
                    if (stats.kills) {
                        gameData.totalKills += stats.kills;
                        
                        // 检查击杀成就
                        if (gameData.totalKills >= 100) {
                            unlockAchievement('killFirst100');
                        }
                        if (gameData.totalKills >= 1000) {
                            unlockAchievement('killFirst1000');
                        }
                    }
                    
                    // 初次游戏成就
                    unlockAchievement('firstRun');
                    
                    saveGameData();
                };
                
                // 创建游戏进度小部件
                const createProgressWidget = () => {
                    const widget = document.createElement('div');
                    widget.id = 'game-progress-widget';
                    widget.style.cssText = `
                        position: fixed;
                        top: 120px;
                        right: 20px;
                        background-color: rgba(25, 43, 33, 0.9);
                        border: 2px solid #34C759;
                        border-radius: 8px;
                        padding: 10px;
                        color: white;
                        font-size: 14px;
                        z-index: 98;
                        max-width: 200px;
                        transform: translateX(100%);
                        transition: transform 0.3s ease;
                        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                    `;
                    
                    // 添加标签按钮
                    const toggleBtn = document.createElement('div');
                    toggleBtn.style.cssText = `
                        position: absolute;
                        top: 10px;
                        left: -40px;
                        background-color: #34C759;
                        color: #192B21;
                        width: 40px;
                        height: 40px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        cursor: pointer;
                        border-radius: 8px 0 0 8px;
                        border: 2px solid #34C759;
                        border-right: none;
                        box-shadow: -2px 2px 5px rgba(0, 0, 0, 0.2);
                        font-size: 20px;
                    `;
                    toggleBtn.innerHTML = '📊';
                    
                    toggleBtn.addEventListener('click', () => {
                        if (widget.style.transform === 'translateX(0px)') {
                            widget.style.transform = 'translateX(100%)';
                        } else {
                            widget.style.transform = 'translateX(0px)';
                            updateProgressWidgetContent();
                        }
                    });
                    
                    widget.appendChild(toggleBtn);
                    
                    // 内容区域
                    const content = document.createElement('div');
                    content.className = 'progress-content';
                    widget.appendChild(content);
                    
                    document.body.appendChild(widget);
                    
                    return {
                        widget,
                        content
                    };
                };
                
                // 更新进度小部件内容
                const updateProgressWidgetContent = () => {
                    if (!progressWidgetElements) return;
                    
                    const { content } = progressWidgetElements;
                    
                    // 计算成就完成度
                    const totalAchievements = achievements.length;
                    const unlockedAchievements = achievements.filter(
                        a => gameData.achievements[a.id]
                    ).length;
                    const completionPercentage = Math.round((unlockedAchievements / totalAchievements) * 100);
                    
                    // 格式化最高存活时间
                    const formatTime = (seconds) => {
                        const minutes = Math.floor(seconds / 60);
                        const remainingSeconds = seconds % 60;
                        return `${minutes}m ${remainingSeconds}s`;
                    };
                    
                    content.innerHTML = `
                        <h3 style="margin: 0 0 10px 0; color: #34C759; text-align: center;">Game Progress</h3>
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Achievement Progress:</span>
                                <span>${unlockedAchievements}/${totalAchievements} (${completionPercentage}%)</span>
                            </div>
                            <div style="height: 8px; background-color: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
                                <div style="height: 100%; width: ${completionPercentage}%; background-color: #34C759;"></div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 8px; display: flex; justify-content: space-between;">
                            <span>Total Monsters Slain:</span>
                            <span>${gameData.totalKills}</span>
                        </div>
                        
                        <div style="margin-bottom: 8px; display: flex; justify-content: space-between;">
                            <span>Longest Survival Time:</span>
                            <span>${formatTime(gameData.highestSurvivalTime)}</span>
                        </div>
                        
                        <div style="margin-bottom: 8px; display: flex; justify-content: space-between;">
                            <span>Consecutive Days:</span>
                            <span>${gameData.consecutiveDays} day${gameData.consecutiveDays !== 1 ? 's' : ''}</span>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <h4 style="margin: 0 0 8px 0; color: #34C759;">Recent Achievements:</h4>
                            <div style="max-height: 80px; overflow-y: auto;">
                                ${achievements.filter(a => gameData.achievements[a.id])
                                    .slice(-3)
                                    .map(a => `<div style="display: flex; align-items: center; margin-bottom: 5px;">
                                        <span style="margin-right: 5px;">${a.icon}</span>
                                        <span style="font-size: 12px;">${a.name}</span>
                                    </div>`)
                                    .join('') || '<div style="opacity: 0.7; font-size: 12px;">No achievements unlocked yet!</div>'}
                            </div>
                        </div>
                        
                        <button id="view-all-achievements" style="
                            margin-top: 10px;
                            width: 100%;
                            background-color: #34C759;
                            color: #192B21;
                            border: none;
                            padding: 8px;
                            border-radius: 4px;
                            cursor: pointer;
                            font-weight: bold;
                        ">View All Achievements</button>
                    `;
                    
                    // 添加"查看所有成就"按钮事件
                    document.getElementById('view-all-achievements').addEventListener('click', showAchievementsModal);
                };
                
                // 显示所有成就的模态窗口
                const showAchievementsModal = () => {
                    const modal = document.createElement('div');
                    modal.className = 'achievements-modal';
                    modal.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background-color: rgba(0, 0, 0, 0.7);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        z-index: 999;
                    `;
                    
                    const content = document.createElement('div');
                    content.style.cssText = `
                        background-color: #192B21;
                        border: 4px solid #34C759;
                        border-radius: 10px;
                        width: 90%;
                        max-width: 600px;
                        max-height: 80vh;
                        overflow-y: auto;
                        padding: 20px;
                        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
                    `;
                    
                    content.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h2 style="margin: 0; color: #34C759;">Game Achievements</h2>
                            <button id="close-achievements-modal" style="
                                background: none;
                                border: none;
                                font-size: 24px;
                                color: white;
                                cursor: pointer;
                            ">&times;</button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                            ${achievements.map(achievement => {
                                const isUnlocked = gameData.achievements[achievement.id];
                                return `
                                    <div style="
                                        border: 2px solid ${isUnlocked ? '#34C759' : '#555'};
                                        border-radius: 8px;
                                        padding: 12px;
                                        background-color: ${isUnlocked ? 'rgba(52, 199, 89, 0.1)' : 'rgba(50, 50, 50, 0.3)'};
                                        opacity: ${isUnlocked ? '1' : '0.7'};
                                    ">
                                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                            <span style="font-size: 24px; margin-right: 10px;">${achievement.icon}</span>
                                            <span style="font-weight: bold; color: ${isUnlocked ? '#34C759' : '#aaa'};">
                                                ${achievement.name}
                                            </span>
                                        </div>
                                        <div style="font-size: 13px;">${achievement.description}</div>
                                        <div style="
                                            margin-top: 8px; 
                                            padding: 4px 8px;
                                            font-size: 12px;
                                            display: inline-block;
                                            border-radius: 10px;
                                            background-color: ${isUnlocked ? 'rgba(52, 199, 89, 0.7)' : 'rgba(100, 100, 100, 0.3)'};
                                        ">
                                            ${isUnlocked ? 'Unlocked' : 'Locked'}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                    
                    modal.appendChild(content);
                    document.body.appendChild(modal);
                    
                    // 关闭按钮事件
                    document.getElementById('close-achievements-modal').addEventListener('click', () => {
                        modal.remove();
                    });
                };
                
                // 初始化
                loadGameData();
                let progressWidgetElements = createProgressWidget();
                
                // 导出公共方法
                return {
                    updateGameStats,
                    unlockAchievement,
                    showAchievementsModal,
                    getPlayerData: () => ({...gameData})
                };
            })();
            
            // 暴露给全局，供游戏主程序使用
            window.achievementSystem = achievementSystem;
            
            // 测试解锁成就 (模拟游戏结束时调用)
            setTimeout(() => {
                achievementSystem.updateGameStats({
                    survivalTime: 125, // 2分5秒
                    kills: 35
                });
            }, 3000);
        });
    </script>
    
    <!-- 离线游戏功能和通知系统 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 游戏提醒系统
            const reminderSystem = (() => {
                // 检查通知权限
                const checkNotificationPermission = async () => {
                    if (!('Notification' in window)) {
                        return false;
                    }
                    
                    if (Notification.permission === 'granted') {
                        return true;
                    }
                    
                    if (Notification.permission !== 'denied') {
                        const permission = await Notification.requestPermission();
                        return permission === 'granted';
                    }
                    
                    return false;
                };
                
                // 发送提醒通知
                const sendNotification = async (title, options) => {
                    const hasPermission = await checkNotificationPermission();
                    if (!hasPermission) return;
                    
                    try {
                        const notification = new Notification(title, {
                            icon: '/images/icon-192.png',
                            badge: '/images/icon-192.png',
                            ...options
                        });
                        
                        notification.onclick = () => {
                            window.focus();
                            notification.close();
                        };
                        
                        return notification;
                    } catch (error) {
                        console.warn('发送通知失败:', error);
                    }
                };
                
                // 设置每日提醒
                const setDailyReminder = () => {
                    if (!('localStorage' in window)) return;
                    
                    try {
                        // 获取上次提醒时间
                        const lastReminder = localStorage.getItem('lastReminderDate');
                        const now = new Date();
                        const today = now.toISOString().split('T')[0];
                        
                        // 检查是否已经今天提醒过
                        if (lastReminder === today) return;
                        
                        // 设置第二天的提醒
                        const tomorrow = new Date();
                        tomorrow.setDate(tomorrow.getDate() + 1);
                        tomorrow.setHours(19, 0, 0, 0); // 晚上7点提醒
                        
                        const timeUntilReminder = tomorrow.getTime() - now.getTime();
                        
                        setTimeout(async () => {
                            await sendNotification('Monster Survivors 想你了!', {
                                body: '你已经有一天没有玩Monster Survivors了！来继续你的冒险吧！',
                                requireInteraction: true
                            });
                            
                            localStorage.setItem('lastReminderDate', new Date().toISOString().split('T')[0]);
                            setDailyReminder(); // 设置下一个提醒
                        }, timeUntilReminder);
                        
                    } catch (error) {
                        console.warn('设置提醒失败:', error);
                    }
                };
                
                // 初始化
                checkNotificationPermission();
                setDailyReminder();
                
                // 导出公共方法
                return {
                    sendNotification,
                    requestPermission: checkNotificationPermission
                };
            })();
            
            // 暴露给全局，供游戏主程序使用
            window.reminderSystem = reminderSystem;
            
            // 添加特殊活动提醒
            const checkSpecialEvents = () => {
                const now = new Date();
                const dayOfWeek = now.getDay();
                const currentHour = now.getHours();
                
                // 周末双倍经验提醒
                if ((dayOfWeek === 5 && currentHour >= 18) || // 周五晚上
                    dayOfWeek === 6 || dayOfWeek === 0) {     // 周六和周日
                    
                    // 显示周末活动提示
                    const eventAlert = document.createElement('div');
                    eventAlert.className = 'special-event-alert';
                    eventAlert.style.cssText = `
                        position: fixed;
                        top: 80px;
                        left: 50%;
                        transform: translateX(-50%);
                        background-color: #FFD700;
                        color: #192B21;
                        padding: 10px 20px;
                        border-radius: 30px;
                        font-weight: bold;
                        z-index: 90;
                        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                        display: flex;
                        align-items: center;
                        animation: pulse-animation 2s infinite;
                    `;
                    
                    eventAlert.innerHTML = `
                        <span style="font-size: 20px; margin-right: 8px;">🎉</span>
                        Weekend Event: Double XP & Increased Rare Item Drop Rate!
                    `;
                    
                    // 添加到页面
                    document.body.appendChild(eventAlert);
                    
                    // 添加动画样式
                    const style = document.createElement('style');
                    style.textContent = `
                        @keyframes pulse-animation {
                            0% { transform: translateX(-50%) scale(1); }
                            50% { transform: translateX(-50%) scale(1.05); }
                            100% { transform: translateX(-50%) scale(1); }
                        }
                    `;
                    document.head.appendChild(style);
                }
            };
            
            // 检查特殊活动
            checkSpecialEvents();
        });
    </script>

    <!-- 游戏结束时的广告容器 -->
    <div id="game-over-ad-container" class="hidden fixed top-0 left-0 w-full h-full bg-black bg-opacity-80 z-50 flex items-center justify-center">
        <div class="relative bg-game-darkbg border-4 border-game-neongreen rounded-lg p-6 max-w-md w-full">
            <div class="ad-placeholder mb-4 bg-gray-800 rounded-lg" style="height: 250px; width: 100%;">
                <!-- 游戏结束广告将在这里显示 -->
                <div class="flex items-center justify-center h-full text-gray-400">Loading Ad...</div>
            </div>
            <div class="flex justify-between">
                <button id="ad-skip-button" class="px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                    Skip (<span id="ad-skip-timer">5</span>)
                </button>
                <button id="continue-button" class="px-4 py-2 bg-game-neongreen text-game-darkbg rounded-lg hover:bg-green-400 transition-colors">
                    Continue Game
                </button>
            </div>
        </div>
    </div>

    <!-- 侧边栏广告容器 -->
    <div id="sidebar-ad-container" class="fixed right-0 top-1/4 transform -translate-y-1/2 z-40">
        <div class="ad-placeholder bg-gray-800 rounded-l-lg overflow-hidden" style="height: 600px; width: 160px;">
            <!-- 侧边栏广告将在这里显示 -->
            <div class="flex items-center justify-center h-full text-gray-400 writing-mode-vertical-rl">
                Ad Space
            </div>
        </div>
    </div>

    <!-- 原生广告 - 游戏内道具 -->
    <div id="sponsored-items-container" class="hidden">
        <div class="native-ad-item flex items-center p-2 border border-game-neongreen rounded-lg mb-2 bg-opacity-30 bg-black">
            <div class="native-ad-icon mr-2 rounded-lg overflow-hidden" style="width: 40px; height: 40px;">
                <div class="w-full h-full bg-gray-700"></div>
            </div>
            <div class="native-ad-content flex-1">
                <div class="native-ad-title text-game-neongreen font-bold text-sm">Special Item Name</div>
                <div class="native-ad-description text-xs text-gray-300">Item description will appear here</div>
            </div>
            <div class="native-ad-cta">
                <button class="bg-game-neongreen text-game-darkbg px-2 py-1 rounded text-xs">Get</button>
            </div>
        </div>
    </div>

    <!-- 广告管理脚本 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 广告管理系统
            const adManager = (() => {
                // 广告状态
                let adsInitialized = false;
                let pendingAdRequests = [];
                let userConsentGiven = localStorage.getItem('adConsent') === 'true';
                
                // 检查是否可以加载广告
                const canLoadAds = () => {
                    return !navigator.doNotTrack && userConsentGiven && !document.hidden;
                };
                
                // 初始化广告系统
                const initAds = () => {
                    if (adsInitialized) return;
                    
                    if (!canLoadAds()) {
                        return showConsentDialog();
                    }
                    
                    // 模拟AdSense代码加载 (实际项目中替换为真实AdSense代码)
                    const script = document.createElement('script');
                    script.async = true;
                    script.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
                    script.setAttribute('data-ad-client', 'ca-pub-XXXXXXXXXXXXXXXX');
                    script.onload = () => {
                        adsInitialized = true;
                        console.log('广告系统已初始化');
                        // 处理等待中的广告请求
                        processPendingAds();
                    };
                    script.onerror = () => {
                        console.warn('广告系统加载失败，使用备用方案');
                        loadBackupAds();
                    };
                    
                    document.head.appendChild(script);
                };
                
                // 处理挂起的广告请求
                const processPendingAds = () => {
                    while (pendingAdRequests.length > 0) {
                        const { container, type, callback } = pendingAdRequests.shift();
                        loadAd(container, type, callback);
                    }
                };
                
                // 加载备用广告
                const loadBackupAds = () => {
                    // 这里可以使用备用广告网络或直接推广自己的产品
                    const adContainers = document.querySelectorAll('.ad-placeholder');
                    adContainers.forEach(container => {
                        container.innerHTML = `
                            <div class="flex flex-col items-center justify-center h-full p-4">
                                <div class="text-game-neongreen font-bold mb-2">Support Our Game</div>
                                <div class="text-white text-sm text-center mb-3">Please consider sharing or checking out our other products</div>
                                <button class="bg-game-neongreen text-game-darkbg px-3 py-1 rounded">See More Games</button>
                            </div>
                        `;
                        
                        // 通知广告加载完成
                        container.dispatchEvent(new Event('adLoaded'));
                    });
                };
                
                // 显示广告同意对话框
                const showConsentDialog = () => {
                    // 如果已经存在同意对话框，不再创建
                    if (document.getElementById('ad-consent-dialog')) return;
                    
                    const dialog = document.createElement('div');
                    dialog.id = 'ad-consent-dialog';
                    dialog.className = 'fixed bottom-0 left-0 w-full bg-game-darkbg border-t-4 border-game-neongreen p-4 z-50';
                    dialog.innerHTML = `
                        <div class="max-w-screen-lg mx-auto">
                            <div class="flex flex-col md:flex-row items-start md:items-center justify-between">
                                <div class="mb-3 md:mb-0 md:mr-4">
                                    <h3 class="text-game-neongreen font-bold">We Use Cookies and Ads</h3>
                                    <p class="text-white text-sm mt-1">We use cookies to improve your experience and display relevant ads. By continuing to use this site, you agree to our <a href="/privacy/" class="text-game-neongreen underline">Privacy Policy</a>.</p>
                                </div>
                                <div class="flex space-x-3">
                                    <button id="reject-consent" class="px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">Decline</button>
                                    <button id="accept-consent" class="px-4 py-2 bg-game-neongreen text-game-darkbg rounded-lg hover:bg-green-400 transition-colors">Accept</button>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(dialog);
                    
                    // 绑定事件
                    document.getElementById('accept-consent').addEventListener('click', () => {
                        localStorage.setItem('adConsent', 'true');
                        userConsentGiven = true;
                        dialog.remove();
                        initAds();
                    });
                    
                    document.getElementById('reject-consent').addEventListener('click', () => {
                        localStorage.setItem('adConsent', 'false');
                        userConsentGiven = false;
                        dialog.remove();
                    });
                };
                
                // 加载广告
                const loadAd = (container, type, callback) => {
                    if (!adsInitialized) {
                        pendingAdRequests.push({ container, type, callback });
                        if (!document.querySelector('script[data-ad-client]')) {
                            initAds();
                        }
                        return;
                    }
                    
                    if (!canLoadAds()) {
                        loadAlternativeContent(container);
                        if (callback) callback(false);
                        return;
                    }
                    
                    // 在这里添加实际广告加载代码
                    // 以下是模拟代码，实际项目请替换
                    const adElement = document.createElement('ins');
                    adElement.className = 'adsbygoogle';
                    adElement.style.display = 'block';
                    adElement.setAttribute('data-ad-client', 'ca-pub-XXXXXXXXXXXXXXXX');
                    
                    switch (type) {
                        case 'game-over':
                            adElement.setAttribute('data-ad-slot', 'XXXXXXXXXX');
                            adElement.style.width = '100%';
                            adElement.style.height = '250px';
                            break;
                        case 'sidebar':
                            adElement.setAttribute('data-ad-slot', 'XXXXXXXXXX');
                            adElement.style.width = '160px';
                            adElement.style.height = '600px';
                            break;
                        case 'native':
                            adElement.setAttribute('data-ad-slot', 'XXXXXXXXXX');
                            adElement.setAttribute('data-ad-format', 'native');
                            break;
                        default:
                            adElement.setAttribute('data-ad-slot', 'XXXXXXXXXX');
                            adElement.style.width = '100%';
                            adElement.style.height = '90px';
                    }
                    
                    // 清空容器并添加广告元素
                    container.innerHTML = '';
                    container.appendChild(adElement);
                    
                    // 模拟广告加载
                    setTimeout(() => {
                        console.log(`${type} 广告已加载`);
                        container.dispatchEvent(new Event('adLoaded'));
                        if (callback) callback(true);
                    }, 1000);
                    
                    // 实际项目中使用以下代码：
                    // try {
                    //     (adsbygoogle = window.adsbygoogle || []).push({});
                    // } catch (e) {
                    //     console.error('广告加载失败:', e);
                    //     loadAlternativeContent(container);
                    //     if (callback) callback(false);
                    // }
                };
                
                // 加载替代内容
                const loadAlternativeContent = (container) => {
                    container.innerHTML = `
                        <div class="flex flex-col items-center justify-center h-full p-2 text-center">
                            <div class="text-game-neongreen font-bold text-sm">小小支持</div>
                            <div class="text-white text-xs mb-2">分享游戏帮助我们成长</div>
                            <button class="bg-game-neongreen text-game-darkbg px-2 py-1 rounded text-xs share-game-btn">分享游戏</button>
                        </div>
                    `;
                    
                    // 绑定分享按钮事件
                    container.querySelector('.share-game-btn').addEventListener('click', () => {
                        if (window.handleShareClick) {
                            window.handleShareClick();
                        }
                    });
                };
                
                // 显示游戏结束广告
                const showGameOverAd = (callback) => {
                    const adContainer = document.getElementById('game-over-ad-container');
                    const adPlaceholder = adContainer.querySelector('.ad-placeholder');
                    const skipButton = document.getElementById('ad-skip-button');
                    const skipTimer = document.getElementById('ad-skip-timer');
                    const continueButton = document.getElementById('continue-button');
                    
                    // 显示广告容器
                    adContainer.classList.remove('hidden');
                    
                    // 加载广告
                    loadAd(adPlaceholder, 'game-over', (success) => {
                        console.log('游戏结束广告加载结果:', success);
                    });
                    
                    // 设置跳过计时器
                    let timeLeft = 5;
                    skipTimer.textContent = timeLeft;
                    
                    const timerInterval = setInterval(() => {
                        timeLeft--;
                        skipTimer.textContent = timeLeft;
                        
                        if (timeLeft <= 0) {
                            clearInterval(timerInterval);
                            skipButton.disabled = false;
                            skipButton.textContent = '跳过';
                            skipButton.classList.remove('bg-gray-700');
                            skipButton.classList.add('bg-gray-600', 'hover:bg-gray-500');
                        }
                    }, 1000);
                    
                    // 设置跳过按钮
                    skipButton.disabled = true;
                    skipButton.onclick = () => {
                        if (timeLeft <= 0) {
                            clearInterval(timerInterval);
                            adContainer.classList.add('hidden');
                            if (callback) callback();
                        }
                    };
                    
                    // 设置继续按钮
                    continueButton.onclick = () => {
                        clearInterval(timerInterval);
                        adContainer.classList.add('hidden');
                        if (callback) callback();
                    };
                };
                
                // 初始化侧边栏广告
                const initSidebarAd = () => {
                    const adContainer = document.getElementById('sidebar-ad-container');
                    const adPlaceholder = adContainer.querySelector('.ad-placeholder');
                    
                    // 使用Intersection Observer检测广告可见性
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                loadAd(adPlaceholder, 'sidebar');
                                observer.unobserve(adPlaceholder);
                            }
                        });
                    }, {
                        threshold: 0.5
                    });
                    
                    observer.observe(adPlaceholder);
                };
                
                // 初始化原生广告
                const initNativeAds = () => {
                    const container = document.getElementById('sponsored-items-container');
                    if (!container) return;
                    
                    // 仅在游戏道具页面显示
                    if (window.location.hash.includes('inventory')) {
                        container.classList.remove('hidden');
                        const adItem = container.querySelector('.native-ad-item');
                        loadAd(adItem, 'native');
                    }
                    
                    // 监听哈希变更，检测何时显示道具页面
                    window.addEventListener('hashchange', () => {
                        if (window.location.hash.includes('inventory')) {
                            container.classList.remove('hidden');
                            const adItem = container.querySelector('.native-ad-item');
                            loadAd(adItem, 'native');
                        } else {
                            container.classList.add('hidden');
                        }
                    });
                };
                
                // 检测网页可见性
                document.addEventListener('visibilitychange', () => {
                    if (!document.hidden && userConsentGiven && !adsInitialized) {
                        initAds();
                    }
                });
                
                // 导出公共方法
                return {
                    init: () => {
                        // 初始用户体验不加载广告，待用户互动后再初始化
                        document.addEventListener('click', () => {
                            if (!adsInitialized) initAds();
                        }, { once: true });
                        
                        initSidebarAd();
                        initNativeAds();
                    },
                    showGameOverAd,
                    loadAd
                };
            })();
            
            // 初始化广告管理器
            adManager.init();
            
            // 暴露给全局，供游戏主程序使用
            window.adManager = adManager;
            
            // 模拟游戏结束事件，展示广告
            // setTimeout(() => {
            //     adManager.showGameOverAd(() => {
            //         console.log('广告展示完成，游戏继续');
            //     });
            // }, 10000);
        });
    </script>

    <!-- ADDITIONAL STRUCTURED DATA -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "url": "https://monstersurvivors.com/",
        "name": "Monster Survivors - Free Retro Pixel Survival Game",
        "description": "Free-to-play pixel art roguelike survival game. Battle endless waves of monsters, upgrade your character, and compete for the highest scores.",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://monstersurvivors.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org/",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://monstersurvivors.com/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Play Game",
                "item": "https://monstersurvivors.com/#play-now"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "Game Guides",
                "item": "https://monstersurvivors.com/blog/"
            }
        ]
    }
    </script>
</body>
</html>